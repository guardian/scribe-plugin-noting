!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;"undefined"!=typeof window?n=window:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.scribePluginNoting=e()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){function pull(array){for(var args=arguments,argsIndex=0,argsLength=args.length,length=array?array.length:0;++argsIndex<argsLength;)for(var index=-1,value=args[argsIndex];++index<length;)array[index]===value&&(splice.call(array,index--,1),length--);return array}var arrayRef=[],splice=arrayRef.splice;module.exports=pull},{}],2:[function(require,module,exports){(function(global){"use strict";(function(){function baseIndexOf(array,value,fromIndex){for(var index=(fromIndex||0)-1,length=array?array.length:0;++index<length;)if(array[index]===value)return index;return-1}function cacheIndexOf(cache,value){var type=typeof value;if(cache=cache.cache,"boolean"==type||null==value)return cache[value]?0:-1;"number"!=type&&"string"!=type&&(type="object");var key="number"==type?value:keyPrefix+value;return cache=(cache=cache[type])&&cache[key],"object"==type?cache&&baseIndexOf(cache,value)>-1?0:-1:cache?0:-1}function cachePush(value){var cache=this.cache,type=typeof value;if("boolean"==type||null==value)cache[value]=!0;else{"number"!=type&&"string"!=type&&(type="object");var key="number"==type?value:keyPrefix+value,typeCache=cache[type]||(cache[type]={});"object"==type?(typeCache[key]||(typeCache[key]=[])).push(value):typeCache[key]=!0}}function charAtCallback(value){return value.charCodeAt(0)}function compareAscending(a,b){for(var ac=a.criteria,bc=b.criteria,index=-1,length=ac.length;++index<length;){var value=ac[index],other=bc[index];if(value!==other){if(value>other||"undefined"==typeof value)return 1;if(other>value||"undefined"==typeof other)return-1}}return a.index-b.index}function createCache(array){var index=-1,length=array.length,first=array[0],mid=array[length/2|0],last=array[length-1];if(first&&"object"==typeof first&&mid&&"object"==typeof mid&&last&&"object"==typeof last)return!1;var cache=getObject();cache["false"]=cache["null"]=cache["true"]=cache.undefined=!1;var result=getObject();for(result.array=array,result.cache=cache,result.push=cachePush;++index<length;)result.push(array[index]);return result}function escapeStringChar(match){return"\\"+stringEscapes[match]}function getArray(){return arrayPool.pop()||[]}function getObject(){return objectPool.pop()||{array:null,cache:null,criteria:null,"false":!1,index:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,value:null}}function isNode(value){return"function"!=typeof value.toString&&"string"==typeof(value+"")}function releaseArray(array){array.length=0,arrayPool.length<maxPoolSize&&arrayPool.push(array)}function releaseObject(object){var cache=object.cache;cache&&releaseObject(cache),object.array=object.cache=object.criteria=object.object=object.number=object.string=object.value=null,objectPool.length<maxPoolSize&&objectPool.push(object)}function slice(array,start,end){start||(start=0),"undefined"==typeof end&&(end=array?array.length:0);for(var index=-1,length=end-start||0,result=Array(0>length?0:length);++index<length;)result[index]=array[start+index];return result}function runInContext(context){function lodash(value){return value&&"object"==typeof value&&!isArray(value)&&hasOwnProperty.call(value,"__wrapped__")?value:new lodashWrapper(value)}function lodashWrapper(value,chainAll){this.__chain__=!!chainAll,this.__wrapped__=value}function baseBind(bindData){function bound(){if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if(this instanceof bound){var thisBinding=baseCreate(func.prototype),result=func.apply(thisBinding,args||arguments);return isObject(result)?result:thisBinding}return func.apply(thisArg,args||arguments)}var func=bindData[0],partialArgs=bindData[2],thisArg=bindData[4];return setBindData(bound,bindData),bound}function baseClone(value,isDeep,callback,stackA,stackB){if(callback){var result=callback(value);if("undefined"!=typeof result)return result}var isObj=isObject(value);if(!isObj)return value;var className=toString.call(value);if(!cloneableClasses[className]||!support.nodeClass&&isNode(value))return value;var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return new ctor(+value);case numberClass:case stringClass:return new ctor(value);case regexpClass:return result=ctor(value.source,reFlags.exec(value)),result.lastIndex=value.lastIndex,result}var isArr=isArray(value);if(isDeep){var initedStack=!stackA;stackA||(stackA=getArray()),stackB||(stackB=getArray());for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];result=isArr?ctor(value.length):{}}else result=isArr?slice(value):assign({},value);return isArr&&(hasOwnProperty.call(value,"index")&&(result.index=value.index),hasOwnProperty.call(value,"input")&&(result.input=value.input)),isDeep?(stackA.push(value),stackB.push(result),(isArr?baseEach:forOwn)(value,function(objValue,key){result[key]=baseClone(objValue,isDeep,callback,stackA,stackB)}),initedStack&&(releaseArray(stackA),releaseArray(stackB)),result):result}function baseCreate(prototype){return isObject(prototype)?nativeCreate(prototype):{}}function baseCreateCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if("undefined"==typeof thisArg||!("prototype"in func))return func;var bindData=func.__bindData__;if("undefined"==typeof bindData&&(support.funcNames&&(bindData=!func.name),bindData=bindData||!support.funcDecomp,!bindData)){var source=fnToString.call(func);support.funcNames||(bindData=!reFuncName.test(source)),bindData||(bindData=reThis.test(source),setBindData(func,bindData))}if(bindData===!1||bindData!==!0&&1&bindData[1])return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 2:return function(a,b){return func.call(thisArg,a,b)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}}return bind(func,thisArg)}function baseCreateWrapper(bindData){function bound(){var thisBinding=isBind?thisArg:this;if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}if((partialRightArgs||isCurry)&&(args||(args=slice(arguments)),partialRightArgs&&push.apply(args,partialRightArgs),isCurry&&args.length<arity))return bitmask|=16,baseCreateWrapper([func,isCurryBound?bitmask:-4&bitmask,args,null,thisArg,arity]);if(args||(args=arguments),isBindKey&&(func=thisBinding[key]),this instanceof bound){thisBinding=baseCreate(func.prototype);var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}return func.apply(thisBinding,args)}var func=bindData[0],bitmask=bindData[1],partialArgs=bindData[2],partialRightArgs=bindData[3],thisArg=bindData[4],arity=bindData[5],isBind=1&bitmask,isBindKey=2&bitmask,isCurry=4&bitmask,isCurryBound=8&bitmask,key=func;return setBindData(bound,bindData),bound}function baseDifference(array,values){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,isLarge=length>=largeArraySize&&indexOf===baseIndexOf,result=[];if(isLarge){var cache=createCache(values);cache?(indexOf=cacheIndexOf,values=cache):isLarge=!1}for(;++index<length;){var value=array[index];indexOf(values,value)<0&&result.push(value)}return isLarge&&releaseObject(values),result}function baseFlatten(array,isShallow,isStrict,fromIndex){for(var index=(fromIndex||0)-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];if(value&&"object"==typeof value&&"number"==typeof value.length&&(isArray(value)||isArguments(value))){isShallow||(value=baseFlatten(value,isShallow,isStrict));var valIndex=-1,valLength=value.length,resIndex=result.length;for(result.length+=valLength;++valIndex<valLength;)result[resIndex++]=value[valIndex]}else isStrict||result.push(value)}return result}function baseIsEqual(a,b,callback,isWhere,stackA,stackB){if(callback){var result=callback(a,b);if("undefined"!=typeof result)return!!result}if(a===b)return 0!==a||1/a==1/b;var type=typeof a,otherType=typeof b;if(!(a!==a||a&&objectTypes[type]||b&&objectTypes[otherType]))return!1;if(null==a||null==b)return a===b;var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass&&(className=objectClass),otherClass==argsClass&&(otherClass=objectClass),className!=otherClass)return!1;switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case regexpClass:case stringClass:return a==String(b)}var isArr=className==arrayClass;if(!isArr){var aWrapped=hasOwnProperty.call(a,"__wrapped__"),bWrapped=hasOwnProperty.call(b,"__wrapped__");if(aWrapped||bWrapped)return baseIsEqual(aWrapped?a.__wrapped__:a,bWrapped?b.__wrapped__:b,callback,isWhere,stackA,stackB);if(className!=objectClass||!support.nodeClass&&(isNode(a)||isNode(b)))return!1;var ctorA=!support.argsObject&&isArguments(a)?Object:a.constructor,ctorB=!support.argsObject&&isArguments(b)?Object:b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB)&&"constructor"in a&&"constructor"in b)return!1}var initedStack=!stackA;stackA||(stackA=getArray()),stackB||(stackB=getArray());for(var length=stackA.length;length--;)if(stackA[length]==a)return stackB[length]==b;var size=0;if(result=!0,stackA.push(a),stackB.push(b),isArr){if(length=a.length,size=b.length,result=size==length,result||isWhere)for(;size--;){var index=length,value=b[size];if(isWhere)for(;index--&&!(result=baseIsEqual(a[index],value,callback,isWhere,stackA,stackB)););else if(!(result=baseIsEqual(a[size],value,callback,isWhere,stackA,stackB)))break}}else forIn(b,function(value,key,b){return hasOwnProperty.call(b,key)?(size++,result=hasOwnProperty.call(a,key)&&baseIsEqual(a[key],value,callback,isWhere,stackA,stackB)):void 0}),result&&!isWhere&&forIn(a,function(value,key,a){return hasOwnProperty.call(a,key)?result=--size>-1:void 0});return stackA.pop(),stackB.pop(),initedStack&&(releaseArray(stackA),releaseArray(stackB)),result}function baseMerge(object,source,callback,stackA,stackB){(isArray(source)?forEach:forOwn)(source,function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){for(var stackLength=stackA.length;stackLength--;)if(found=stackA[stackLength]==source){value=stackB[stackLength];break}if(!found){var isShallow;callback&&(result=callback(value,source),(isShallow="undefined"!=typeof result)&&(value=result)),isShallow||(value=isArr?isArray(value)?value:[]:isPlainObject(value)?value:{}),stackA.push(source),stackB.push(value),isShallow||baseMerge(value,source,callback,stackA,stackB)}}else callback&&(result=callback(value,source),"undefined"==typeof result&&(result=source)),"undefined"!=typeof result&&(value=result);object[key]=value})}function baseRandom(min,max){return min+floor(nativeRandom()*(max-min+1))}function baseUniq(array,isSorted,callback){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[],isLarge=!isSorted&&length>=largeArraySize&&indexOf===baseIndexOf,seen=callback||isLarge?getArray():result;if(isLarge){var cache=createCache(seen);indexOf=cacheIndexOf,seen=cache}for(;++index<length;){var value=array[index],computed=callback?callback(value,index,array):value;(isSorted?!index||seen[seen.length-1]!==computed:indexOf(seen,computed)<0)&&((callback||isLarge)&&seen.push(computed),result.push(value))}return isLarge?(releaseArray(seen.array),releaseObject(seen)):callback&&releaseArray(seen),result}function createAggregator(setter){return function(collection,callback,thisArg){var result={};if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,callback(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,callback(value,key,collection),collection)});return result}}function createWrapper(func,bitmask,partialArgs,partialRightArgs,thisArg,arity){var isBind=1&bitmask,isBindKey=2&bitmask,isCurry=4&bitmask,isPartial=16&bitmask,isPartialRight=32&bitmask;if(!isBindKey&&!isFunction(func))throw new TypeError;isPartial&&!partialArgs.length&&(bitmask&=-17,isPartial=partialArgs=!1),isPartialRight&&!partialRightArgs.length&&(bitmask&=-33,isPartialRight=partialRightArgs=!1);var bindData=func&&func.__bindData__;if(bindData&&bindData!==!0)return bindData=slice(bindData),bindData[2]&&(bindData[2]=slice(bindData[2])),bindData[3]&&(bindData[3]=slice(bindData[3])),!isBind||1&bindData[1]||(bindData[4]=thisArg),!isBind&&1&bindData[1]&&(bitmask|=8),!isCurry||4&bindData[1]||(bindData[5]=arity),isPartial&&push.apply(bindData[2]||(bindData[2]=[]),partialArgs),isPartialRight&&unshift.apply(bindData[3]||(bindData[3]=[]),partialRightArgs),bindData[1]|=bitmask,createWrapper.apply(null,bindData);var creater=1==bitmask||17===bitmask?baseBind:baseCreateWrapper;return creater([func,bitmask,partialArgs,partialRightArgs,thisArg,arity])}function createIterator(){iteratorData.shadowedProps=shadowedProps,iteratorData.array=iteratorData.bottom=iteratorData.loop=iteratorData.top="",iteratorData.init="iterable",iteratorData.useHas=!0;for(var object,index=0;object=arguments[index];index++)for(var key in object)iteratorData[key]=object[key];var args=iteratorData.args;iteratorData.firstArg=/^[^,]+/.exec(args)[0];var factory=Function("baseCreateCallback, errorClass, errorProto, hasOwnProperty, indicatorObject, isArguments, isArray, isString, keys, objectProto, objectTypes, nonEnumProps, stringClass, stringProto, toString","return function("+args+") {\n"+iteratorTemplate(iteratorData)+"\n}");return factory(baseCreateCallback,errorClass,errorProto,hasOwnProperty,indicatorObject,isArguments,isArray,isString,iteratorData.keys,objectProto,objectTypes,nonEnumProps,stringClass,stringProto,toString)}function escapeHtmlChar(match){return htmlEscapes[match]}function getIndexOf(){var result=(result=lodash.indexOf)===indexOf?baseIndexOf:result;return result}function isNative(value){return"function"==typeof value&&reNative.test(value)}function shimIsPlainObject(value){var ctor,result;return!value||toString.call(value)!=objectClass||(ctor=value.constructor,isFunction(ctor)&&!(ctor instanceof ctor))||!support.argsClass&&isArguments(value)||!support.nodeClass&&isNode(value)?!1:support.ownLast?(forIn(value,function(value,key,object){return result=hasOwnProperty.call(object,key),!1}),result!==!1):(forIn(value,function(value,key){result=key}),"undefined"==typeof result||hasOwnProperty.call(value,result))}function unescapeHtmlChar(match){return htmlUnescapes[match]}function isArguments(value){return value&&"object"==typeof value&&"number"==typeof value.length&&toString.call(value)==argsClass||!1}function clone(value,isDeep,callback,thisArg){return"boolean"!=typeof isDeep&&null!=isDeep&&(thisArg=callback,callback=isDeep,isDeep=!1),baseClone(value,isDeep,"function"==typeof callback&&baseCreateCallback(callback,thisArg,1))}function cloneDeep(value,callback,thisArg){return baseClone(value,!0,"function"==typeof callback&&baseCreateCallback(callback,thisArg,1))}function create(prototype,properties){var result=baseCreate(prototype);return properties?assign(result,properties):result}function findKey(object,callback,thisArg){var result;return callback=lodash.createCallback(callback,thisArg,3),forOwn(object,function(value,key,object){return callback(value,key,object)?(result=key,!1):void 0}),result}function findLastKey(object,callback,thisArg){var result;return callback=lodash.createCallback(callback,thisArg,3),forOwnRight(object,function(value,key,object){return callback(value,key,object)?(result=key,!1):void 0}),result}function forInRight(object,callback,thisArg){var pairs=[];forIn(object,function(value,key){pairs.push(key,value)});var length=pairs.length;for(callback=baseCreateCallback(callback,thisArg,3);length--&&callback(pairs[length--],pairs[length],object)!==!1;);return object}function forOwnRight(object,callback,thisArg){var props=keys(object),length=props.length;for(callback=baseCreateCallback(callback,thisArg,3);length--;){var key=props[length];if(callback(object[key],key,object)===!1)break}return object}function functions(object){var result=[];return forIn(object,function(value,key){isFunction(value)&&result.push(key)}),result.sort()}function has(object,key){return object?hasOwnProperty.call(object,key):!1}function invert(object){for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index];result[object[key]]=key}return result}function isBoolean(value){return value===!0||value===!1||value&&"object"==typeof value&&toString.call(value)==boolClass||!1}function isDate(value){return value&&"object"==typeof value&&toString.call(value)==dateClass||!1}function isElement(value){return value&&1===value.nodeType||!1}function isEmpty(value){var result=!0;if(!value)return result;var className=toString.call(value),length=value.length;return className==arrayClass||className==stringClass||(support.argsClass?className==argsClass:isArguments(value))||className==objectClass&&"number"==typeof length&&isFunction(value.splice)?!length:(forOwn(value,function(){return result=!1}),result)}function isEqual(a,b,callback,thisArg){return baseIsEqual(a,b,"function"==typeof callback&&baseCreateCallback(callback,thisArg,2))}function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}function isFunction(value){return"function"==typeof value}function isObject(value){return!(!value||!objectTypes[typeof value])}function isNaN(value){return isNumber(value)&&value!=+value}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||value&&"object"==typeof value&&toString.call(value)==numberClass||!1}function isRegExp(value){return value&&objectTypes[typeof value]&&toString.call(value)==regexpClass||!1}function isString(value){return"string"==typeof value||value&&"object"==typeof value&&toString.call(value)==stringClass||!1}function isUndefined(value){return"undefined"==typeof value}function mapValues(object,callback,thisArg){var result={};return callback=lodash.createCallback(callback,thisArg,3),forOwn(object,function(value,key,object){result[key]=callback(value,key,object)}),result}function merge(object){var args=arguments,length=2;if(!isObject(object))return object;if("number"!=typeof args[2]&&(length=args.length),length>3&&"function"==typeof args[length-2])var callback=baseCreateCallback(args[--length-1],args[length--],2);else length>2&&"function"==typeof args[length-1]&&(callback=args[--length]);for(var sources=slice(arguments,1,length),index=-1,stackA=getArray(),stackB=getArray();++index<length;)baseMerge(object,sources[index],callback,stackA,stackB);return releaseArray(stackA),releaseArray(stackB),object}function omit(object,callback,thisArg){var result={};if("function"!=typeof callback){var props=[];forIn(object,function(value,key){props.push(key)}),props=baseDifference(props,baseFlatten(arguments,!0,!1,1));for(var index=-1,length=props.length;++index<length;){var key=props[index];result[key]=object[key]}}else callback=lodash.createCallback(callback,thisArg,3),forIn(object,function(value,key,object){callback(value,key,object)||(result[key]=value)});return result}function pairs(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}function pick(object,callback,thisArg){var result={};if("function"!=typeof callback)for(var index=-1,props=baseFlatten(arguments,!0,!1,1),length=isObject(object)?props.length:0;++index<length;){var key=props[index];key in object&&(result[key]=object[key])}else callback=lodash.createCallback(callback,thisArg,3),forIn(object,function(value,key,object){callback(value,key,object)&&(result[key]=value)});return result}function transform(object,callback,accumulator,thisArg){var isArr=isArray(object);if(null==accumulator)if(isArr)accumulator=[];else{var ctor=object&&object.constructor,proto=ctor&&ctor.prototype;accumulator=baseCreate(proto)}return callback&&(callback=lodash.createCallback(callback,thisArg,4),(isArr?baseEach:forOwn)(object,function(value,index,object){return callback(accumulator,value,index,object)})),accumulator}function values(object){for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function at(collection){var args=arguments,index=-1,props=baseFlatten(args,!0,!1,1),length=args[2]&&args[2][args[1]]===collection?1:props.length,result=Array(length);for(support.unindexedChars&&isString(collection)&&(collection=collection.split(""));++index<length;)result[index]=collection[props[index]];return result}function contains(collection,target,fromIndex){var index=-1,indexOf=getIndexOf(),length=collection?collection.length:0,result=!1;return fromIndex=(0>fromIndex?nativeMax(0,length+fromIndex):fromIndex)||0,isArray(collection)?result=indexOf(collection,target,fromIndex)>-1:"number"==typeof length?result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1:baseEach(collection,function(value){return++index>=fromIndex?!(result=value===target):void 0}),result}function every(collection,callback,thisArg){var result=!0;if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length&&(result=!!callback(collection[index],index,collection)););else baseEach(collection,function(value,index,collection){return result=!!callback(value,index,collection)});return result}function filter(collection,callback,thisArg){var result=[];if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];callback(value,index,collection)&&result.push(value)}else baseEach(collection,function(value,index,collection){callback(value,index,collection)&&result.push(value)});return result}function find(collection,callback,thisArg){if(callback=lodash.createCallback(callback,thisArg,3),!isArray(collection)){var result;return baseEach(collection,function(value,index,collection){return callback(value,index,collection)?(result=value,!1):void 0}),result}for(var index=-1,length=collection.length;++index<length;){var value=collection[index];if(callback(value,index,collection))return value}}function findLast(collection,callback,thisArg){var result;return callback=lodash.createCallback(callback,thisArg,3),forEachRight(collection,function(value,index,collection){return callback(value,index,collection)?(result=value,!1):void 0}),result}function forEach(collection,callback,thisArg){if(callback&&"undefined"==typeof thisArg&&isArray(collection))for(var index=-1,length=collection.length;++index<length&&callback(collection[index],index,collection)!==!1;);else baseEach(collection,callback,thisArg);return collection}function forEachRight(collection,callback,thisArg){var iterable=collection,length=collection?collection.length:0;if(callback=callback&&"undefined"==typeof thisArg?callback:baseCreateCallback(callback,thisArg,3),isArray(collection))for(;length--&&callback(collection[length],length,collection)!==!1;);else{if("number"!=typeof length){var props=keys(collection);length=props.length}else support.unindexedChars&&isString(collection)&&(iterable=collection.split(""));baseEach(collection,function(value,key,collection){return key=props?props[--length]:--length,callback(iterable[key],key,collection)})}return collection}function invoke(collection,methodName){var args=slice(arguments,2),index=-1,isFunc="function"==typeof methodName,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)}),result}function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(;++index<length;)result[index]=callback(collection[index],index,collection);else baseEach(collection,function(value,key,collection){result[++index]=callback(value,key,collection)});return result}function max(collection,callback,thisArg){var computed=-1/0,result=computed;if("function"!=typeof callback&&thisArg&&thisArg[callback]===collection&&(callback=null),null==callback&&isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];value>result&&(result=value)}else callback=null==callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3),baseEach(collection,function(value,index,collection){var current=callback(value,index,collection);current>computed&&(computed=current,result=value)});return result}function min(collection,callback,thisArg){var computed=1/0,result=computed;if("function"!=typeof callback&&thisArg&&thisArg[callback]===collection&&(callback=null),null==callback&&isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];result>value&&(result=value)}else callback=null==callback&&isString(collection)?charAtCallback:lodash.createCallback(callback,thisArg,3),baseEach(collection,function(value,index,collection){var current=callback(value,index,collection);computed>current&&(computed=current,result=value)});return result}function reduce(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;if(callback=lodash.createCallback(callback,thisArg,4),isArray(collection)){var index=-1,length=collection.length;for(noaccum&&(accumulator=collection[++index]);++index<length;)accumulator=callback(accumulator,collection[index],index,collection)}else baseEach(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)});return accumulator}function reduceRight(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;return callback=lodash.createCallback(callback,thisArg,4),forEachRight(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)}),accumulator}function reject(collection,callback,thisArg){return callback=lodash.createCallback(callback,thisArg,3),filter(collection,function(value,index,collection){return!callback(value,index,collection)})}function sample(collection,n,guard){if(collection&&"number"!=typeof collection.length?collection=values(collection):support.unindexedChars&&isString(collection)&&(collection=collection.split("")),null==n||guard)return collection?collection[baseRandom(0,collection.length-1)]:undefined;var result=shuffle(collection);return result.length=nativeMin(nativeMax(0,n),result.length),result}function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array("number"==typeof length?length:0);return forEach(collection,function(value){var rand=baseRandom(0,++index);result[index]=result[rand],result[rand]=value}),result}function size(collection){var length=collection?collection.length:0;return"number"==typeof length?length:keys(collection).length}function some(collection,callback,thisArg){var result;if(callback=lodash.createCallback(callback,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length&&!(result=callback(collection[index],index,collection)););else baseEach(collection,function(value,index,collection){return!(result=callback(value,index,collection))});return!!result}function sortBy(collection,callback,thisArg){var index=-1,isArr=isArray(callback),length=collection?collection.length:0,result=Array("number"==typeof length?length:0);for(isArr||(callback=lodash.createCallback(callback,thisArg,3)),forEach(collection,function(value,key,collection){var object=result[++index]=getObject();isArr?object.criteria=map(callback,function(key){return value[key]}):(object.criteria=getArray())[0]=callback(value,key,collection),object.index=index,object.value=value}),length=result.length,result.sort(compareAscending);length--;){var object=result[length];result[length]=object.value,isArr||releaseArray(object.criteria),releaseObject(object)}return result}function toArray(collection){return collection&&"number"==typeof collection.length?support.unindexedChars&&isString(collection)?collection.split(""):slice(collection):values(collection)}function compact(array){for(var index=-1,length=array?array.length:0,result=[];++index<length;){var value=array[index];value&&result.push(value)}return result}function difference(array){return baseDifference(array,baseFlatten(arguments,!0,!0,1))}function findIndex(array,callback,thisArg){var index=-1,length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg,3);++index<length;)if(callback(array[index],index,array))return index;return-1}function findLastIndex(array,callback,thisArg){var length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg,3);length--;)if(callback(array[length],length,array))return length;return-1}function first(array,callback,thisArg){var n=0,length=array?array.length:0;if("number"!=typeof callback&&null!=callback){var index=-1;for(callback=lodash.createCallback(callback,thisArg,3);++index<length&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array?array[0]:undefined;return slice(array,0,nativeMin(nativeMax(0,n),length))}function flatten(array,isShallow,callback,thisArg){return"boolean"!=typeof isShallow&&null!=isShallow&&(thisArg=callback,callback="function"!=typeof isShallow&&thisArg&&thisArg[isShallow]===array?null:isShallow,isShallow=!1),null!=callback&&(array=map(array,callback,thisArg)),baseFlatten(array,isShallow)}function indexOf(array,value,fromIndex){if("number"==typeof fromIndex){var length=array?array.length:0;fromIndex=0>fromIndex?nativeMax(0,length+fromIndex):fromIndex||0}else if(fromIndex){var index=sortedIndex(array,value);return array[index]===value?index:-1}return baseIndexOf(array,value,fromIndex)}function initial(array,callback,thisArg){var n=0,length=array?array.length:0;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=lodash.createCallback(callback,thisArg,3);index--&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:callback||n;return slice(array,0,nativeMin(nativeMax(0,length-n),length))}function intersection(){for(var args=[],argsIndex=-1,argsLength=arguments.length,caches=getArray(),indexOf=getIndexOf(),trustIndexOf=indexOf===baseIndexOf,seen=getArray();++argsIndex<argsLength;){var value=arguments[argsIndex];(isArray(value)||isArguments(value))&&(args.push(value),caches.push(trustIndexOf&&value.length>=largeArraySize&&createCache(argsIndex?args[argsIndex]:seen)))}var array=args[0],index=-1,length=array?array.length:0,result=[];outer:for(;++index<length;){var cache=caches[0];if(value=array[index],(cache?cacheIndexOf(cache,value):indexOf(seen,value))<0){for(argsIndex=argsLength,(cache||seen).push(value);--argsIndex;)if(cache=caches[argsIndex],(cache?cacheIndexOf(cache,value):indexOf(args[argsIndex],value))<0)continue outer;
result.push(value)}}for(;argsLength--;)cache=caches[argsLength],cache&&releaseObject(cache);return releaseArray(caches),releaseArray(seen),result}function last(array,callback,thisArg){var n=0,length=array?array.length:0;if("number"!=typeof callback&&null!=callback){var index=length;for(callback=lodash.createCallback(callback,thisArg,3);index--&&callback(array[index],index,array);)n++}else if(n=callback,null==n||thisArg)return array?array[length-1]:undefined;return slice(array,nativeMax(0,length-n))}function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;for("number"==typeof fromIndex&&(index=(0>fromIndex?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1);index--;)if(array[index]===value)return index;return-1}function pull(array){for(var args=arguments,argsIndex=0,argsLength=args.length,length=array?array.length:0;++argsIndex<argsLength;)for(var index=-1,value=args[argsIndex];++index<length;)array[index]===value&&(splice.call(array,index--,1),length--);return array}function range(start,end,step){start=+start||0,step="number"==typeof step?step:+step||1,null==end&&(end=start,start=0);for(var index=-1,length=nativeMax(0,ceil((end-start)/(step||1))),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function remove(array,callback,thisArg){var index=-1,length=array?array.length:0,result=[];for(callback=lodash.createCallback(callback,thisArg,3);++index<length;){var value=array[index];callback(value,index,array)&&(result.push(value),splice.call(array,index--,1),length--)}return result}function rest(array,callback,thisArg){if("number"!=typeof callback&&null!=callback){var n=0,index=-1,length=array?array.length:0;for(callback=lodash.createCallback(callback,thisArg,3);++index<length&&callback(array[index],index,array);)n++}else n=null==callback||thisArg?1:nativeMax(0,callback);return slice(array,n)}function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;for(callback=callback?lodash.createCallback(callback,thisArg,1):identity,value=callback(value);high>low;){var mid=low+high>>>1;callback(array[mid])<value?low=mid+1:high=mid}return low}function union(){return baseUniq(baseFlatten(arguments,!0,!0))}function uniq(array,isSorted,callback,thisArg){return"boolean"!=typeof isSorted&&null!=isSorted&&(thisArg=callback,callback="function"!=typeof isSorted&&thisArg&&thisArg[isSorted]===array?null:isSorted,isSorted=!1),null!=callback&&(callback=lodash.createCallback(callback,thisArg,3)),baseUniq(array,isSorted,callback)}function without(array){return baseDifference(array,slice(arguments,1))}function xor(){for(var index=-1,length=arguments.length;++index<length;){var array=arguments[index];if(isArray(array)||isArguments(array))var result=result?baseUniq(baseDifference(result,array).concat(baseDifference(array,result))):array}return result||[]}function zip(){for(var array=arguments.length>1?arguments:arguments[0],index=-1,length=array?max(pluck(array,"length")):0,result=Array(0>length?0:length);++index<length;)result[index]=pluck(array,index);return result}function zipObject(keys,values){var index=-1,length=keys?keys.length:0,result={};for(values||!length||isArray(keys[0])||(values=[]);++index<length;){var key=keys[index];values?result[key]=values[index]:key&&(result[key[0]]=key[1])}return result}function after(n,func){if(!isFunction(func))throw new TypeError;return function(){return--n<1?func.apply(this,arguments):void 0}}function bind(func,thisArg){return arguments.length>2?createWrapper(func,17,slice(arguments,2),null,thisArg):createWrapper(func,1,null,null,thisArg)}function bindAll(object){for(var funcs=arguments.length>1?baseFlatten(arguments,!0,!1,1):functions(object),index=-1,length=funcs.length;++index<length;){var key=funcs[index];object[key]=createWrapper(object[key],1,null,null,object)}return object}function bindKey(object,key){return arguments.length>2?createWrapper(key,19,slice(arguments,2),null,object):createWrapper(key,3,null,null,object)}function compose(){for(var funcs=arguments,length=funcs.length;length--;)if(!isFunction(funcs[length]))throw new TypeError;return function(){for(var args=arguments,length=funcs.length;length--;)args=[funcs[length].apply(this,args)];return args[0]}}function curry(func,arity){return arity="number"==typeof arity?arity:+arity||func.length,createWrapper(func,4,null,null,null,arity)}function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if(!isFunction(func))throw new TypeError;if(wait=nativeMax(0,wait)||0,options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=options.leading,maxWait="maxWait"in options&&(nativeMax(wait,options.maxWait)||0),trailing="trailing"in options?options.trailing:trailing);var delayed=function(){var remaining=wait-(now()-stamp);if(0>=remaining){maxTimeoutId&&clearTimeout(maxTimeoutId);var isCalled=trailingCall;maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=null))}else timeoutId=setTimeout(delayed,remaining)},maxDelayed=function(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId=timeoutId=trailingCall=undefined,(trailing||maxWait!==wait)&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=null))};return function(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=0>=remaining;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=null),result}}function defer(func){if(!isFunction(func))throw new TypeError;var args=slice(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}function delay(func,wait){if(!isFunction(func))throw new TypeError;var args=slice(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}function memoize(func,resolver){if(!isFunction(func))throw new TypeError;var memoized=function(){var cache=memoized.cache,key=resolver?resolver.apply(this,arguments):keyPrefix+arguments[0];return hasOwnProperty.call(cache,key)?cache[key]:cache[key]=func.apply(this,arguments)};return memoized.cache={},memoized}function once(func){var ran,result;if(!isFunction(func))throw new TypeError;return function(){return ran?result:(ran=!0,result=func.apply(this,arguments),func=null,result)}}function partial(func){return createWrapper(func,16,slice(arguments,1))}function partialRight(func){return createWrapper(func,32,null,slice(arguments,1))}function throttle(func,wait,options){var leading=!0,trailing=!0;if(!isFunction(func))throw new TypeError;return options===!1?leading=!1:isObject(options)&&(leading="leading"in options?options.leading:leading,trailing="trailing"in options?options.trailing:trailing),debounceOptions.leading=leading,debounceOptions.maxWait=wait,debounceOptions.trailing=trailing,debounce(func,wait,debounceOptions)}function wrap(value,wrapper){return createWrapper(wrapper,16,[value])}function constant(value){return function(){return value}}function createCallback(func,thisArg,argCount){var type=typeof func;if(null==func||"function"==type)return baseCreateCallback(func,thisArg,argCount);if("object"!=type)return property(func);var props=keys(func),key=props[0],a=func[key];return 1!=props.length||a!==a||isObject(a)?function(object){for(var length=props.length,result=!1;length--&&(result=baseIsEqual(object[props[length]],func[props[length]],null,!0)););return result}:function(object){var b=object[key];return a===b&&(0!==a||1/a==1/b)}}function escape(string){return null==string?"":String(string).replace(reUnescapedHtml,escapeHtmlChar)}function identity(value){return value}function mixin(object,source,options){var chain=!0,methodNames=source&&functions(source);source&&(options||methodNames.length)||(null==options&&(options=source),ctor=lodashWrapper,source=object,object=lodash,methodNames=functions(source)),options===!1?chain=!1:isObject(options)&&"chain"in options&&(chain=options.chain);var ctor=object,isFunc=isFunction(ctor);forEach(methodNames,function(methodName){var func=object[methodName]=source[methodName];isFunc&&(ctor.prototype[methodName]=function(){var chainAll=this.__chain__,value=this.__wrapped__,args=[value];push.apply(args,arguments);var result=func.apply(object,args);if(chain||chainAll){if(value===result&&isObject(result))return this;result=new ctor(result),result.__chain__=chainAll}return result})})}function noConflict(){return context._=oldDash,this}function noop(){}function property(key){return function(object){return object[key]}}function random(min,max,floating){var noMin=null==min,noMax=null==max;if(null==floating&&("boolean"==typeof min&&noMax?(floating=min,min=1):noMax||"boolean"!=typeof max||(floating=max,noMax=!0)),noMin&&noMax&&(max=1),min=+min||0,noMax?(max=min,min=0):max=+max||0,floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function result(object,key){if(object){var value=object[key];return isFunction(value)?object[key]():value}}function template(text,data,options){var settings=lodash.templateSettings;text=String(text||""),options=defaults({},options,settings);var isEvaluating,imports=defaults({},options.imports,settings.imports),importsKeys=keys(imports),importsValues=values(imports),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g");text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable,hasVariable=variable;hasVariable||(variable="obj",source="with ("+variable+") {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+variable+") {\n"+(hasVariable?"":variable+" || ("+variable+" = {});\n")+"var __t, __p = '', __e = _.escape"+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var sourceURL="\n/*\n//# sourceURL="+(options.sourceURL||"/lodash/template/source["+templateCounter++ +"]")+"\n*/";try{var result=Function(importsKeys,"return "+source+sourceURL).apply(undefined,importsValues)}catch(e){throw e.source=source,e}return data?result(data):(result.source=source,result)}function times(n,callback,thisArg){n=(n=+n)>-1?n:0;var index=-1,result=Array(n);for(callback=baseCreateCallback(callback,thisArg,1);++index<n;)result[index]=callback(index);return result}function unescape(string){return null==string?"":String(string).replace(reEscapedHtml,unescapeHtmlChar)}function uniqueId(prefix){var id=++idCounter;return String(null==prefix?"":prefix)+id}function chain(value){return value=new lodashWrapper(value),value.__chain__=!0,value}function tap(value,interceptor){return interceptor(value),value}function wrapperChain(){return this.__chain__=!0,this}function wrapperToString(){return String(this.__wrapped__)}function wrapperValueOf(){return this.__wrapped__}context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Boolean=context.Boolean,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayRef=[],errorProto=Error.prototype,objectProto=Object.prototype,stringProto=String.prototype,oldDash=context._,toString=objectProto.toString,reNative=RegExp("^"+String(toString).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),ceil=Math.ceil,clearTimeout=context.clearTimeout,floor=Math.floor,fnToString=Function.prototype.toString,getPrototypeOf=isNative(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectProto.hasOwnProperty,push=arrayRef.push,propertyIsEnumerable=objectProto.propertyIsEnumerable,setTimeout=context.setTimeout,splice=arrayRef.splice,unshift=arrayRef.unshift,defineProperty=function(){try{var o={},func=isNative(func=Object.defineProperty)&&func,result=func(o,o,o)&&func}catch(e){}return result}(),nativeCreate=isNative(nativeCreate=Object.create)&&nativeCreate,nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=context.isFinite,nativeIsNaN=context.isNaN,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random,ctorByClass={};ctorByClass[arrayClass]=Array,ctorByClass[boolClass]=Boolean,ctorByClass[dateClass]=Date,ctorByClass[funcClass]=Function,ctorByClass[objectClass]=Object,ctorByClass[numberClass]=Number,ctorByClass[regexpClass]=RegExp,ctorByClass[stringClass]=String;var nonEnumProps={};nonEnumProps[arrayClass]=nonEnumProps[dateClass]=nonEnumProps[numberClass]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},nonEnumProps[boolClass]=nonEnumProps[stringClass]={constructor:!0,toString:!0,valueOf:!0},nonEnumProps[errorClass]=nonEnumProps[funcClass]=nonEnumProps[regexpClass]={constructor:!0,toString:!0},nonEnumProps[objectClass]={constructor:!0},function(){for(var length=shadowedProps.length;length--;){var key=shadowedProps[length];for(var className in nonEnumProps)hasOwnProperty.call(nonEnumProps,className)&&!hasOwnProperty.call(nonEnumProps[className],key)&&(nonEnumProps[className][key]=!1)}}(),lodashWrapper.prototype=lodash.prototype;var support=lodash.support={};!function(){var ctor=function(){this.x=1},object={0:1,length:1},props=[];ctor.prototype={valueOf:1,y:1};for(var key in new ctor)props.push(key);for(key in arguments);support.argsClass=toString.call(arguments)==argsClass,support.argsObject=arguments.constructor==Object&&!(arguments instanceof Array),support.enumErrorProps=propertyIsEnumerable.call(errorProto,"message")||propertyIsEnumerable.call(errorProto,"name"),support.enumPrototypes=propertyIsEnumerable.call(ctor,"prototype"),support.funcDecomp=!isNative(context.WinRTError)&&reThis.test(runInContext),support.funcNames="string"==typeof Function.name,support.nonEnumArgs=0!=key,support.nonEnumShadows=!/valueOf/.test(props),support.ownLast="x"!=props[0],support.spliceObjects=(arrayRef.splice.call(object,0,1),!object[0]),support.unindexedChars="x"[0]+Object("x")[0]!="xx";try{support.nodeClass=!(toString.call(document)==objectClass&&!({toString:0}+""))}catch(e){support.nodeClass=!0}}(1),lodash.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var iteratorTemplate=function(obj){var __p="var index, iterable = "+obj.firstArg+", result = "+obj.init+";\nif (!iterable) return result;\n"+obj.top+";";obj.array?(__p+="\nvar length = iterable.length; index = -1;\nif ("+obj.array+") {  ",support.unindexedChars&&(__p+="\n  if (isString(iterable)) {\n    iterable = iterable.split('')\n  }  "),__p+="\n  while (++index < length) {\n    "+obj.loop+";\n  }\n}\nelse {  "):support.nonEnumArgs&&(__p+="\n  var length = iterable.length; index = -1;\n  if (length && isArguments(iterable)) {\n    while (++index < length) {\n      index += '';\n      "+obj.loop+";\n    }\n  } else {  "),support.enumPrototypes&&(__p+="\n  var skipProto = typeof iterable == 'function';\n  "),support.enumErrorProps&&(__p+="\n  var skipErrorProps = iterable === errorProto || iterable instanceof Error;\n  ");var conditions=[];if(support.enumPrototypes&&conditions.push('!(skipProto && index == "prototype")'),support.enumErrorProps&&conditions.push('!(skipErrorProps && (index == "message" || index == "name"))'),obj.useHas&&obj.keys)__p+="\n  var ownIndex = -1,\n      ownProps = objectTypes[typeof iterable] && keys(iterable),\n      length = ownProps ? ownProps.length : 0;\n\n  while (++ownIndex < length) {\n    index = ownProps[ownIndex];\n",conditions.length&&(__p+="    if ("+conditions.join(" && ")+") {\n  "),__p+=obj.loop+";    ",conditions.length&&(__p+="\n    }"),__p+="\n  }  ";else if(__p+="\n  for (index in iterable) {\n",obj.useHas&&conditions.push("hasOwnProperty.call(iterable, index)"),conditions.length&&(__p+="    if ("+conditions.join(" && ")+") {\n  "),__p+=obj.loop+";    ",conditions.length&&(__p+="\n    }"),__p+="\n  }    ",support.nonEnumShadows){for(__p+="\n\n  if (iterable !== objectProto) {\n    var ctor = iterable.constructor,\n        isProto = iterable === (ctor && ctor.prototype),\n        className = iterable === stringProto ? stringClass : iterable === errorProto ? errorClass : toString.call(iterable),\n        nonEnum = nonEnumProps[className];\n      ",k=0;k<7;k++)__p+="\n    index = '"+obj.shadowedProps[k]+"';\n    if ((!(isProto && nonEnum[index]) && hasOwnProperty.call(iterable, index))",obj.useHas||(__p+=" || (!nonEnum[index] && iterable[index] !== objectProto[index])"),__p+=") {\n      "+obj.loop+";\n    }      ";__p+="\n  }    "}return(obj.array||support.nonEnumArgs)&&(__p+="\n}"),__p+=obj.bottom+";\nreturn result"};nativeCreate||(baseCreate=function(){function Object(){}return function(prototype){if(isObject(prototype)){Object.prototype=prototype;var result=new Object;Object.prototype=null}return result||context.Object()}}());var setBindData=defineProperty?function(func,value){descriptor.value=value,defineProperty(func,"__bindData__",descriptor)}:noop;support.argsClass||(isArguments=function(value){return value&&"object"==typeof value&&"number"==typeof value.length&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")||!1});var isArray=nativeIsArray||function(value){return value&&"object"==typeof value&&"number"==typeof value.length&&toString.call(value)==arrayClass||!1},shimKeys=createIterator({args:"object",init:"[]",top:"if (!(objectTypes[typeof object])) return result",loop:"result.push(index)"}),keys=nativeKeys?function(object){return isObject(object)?support.enumPrototypes&&"function"==typeof object||support.nonEnumArgs&&object.length&&isArguments(object)?shimKeys(object):nativeKeys(object):[]}:shimKeys,eachIteratorOptions={args:"collection, callback, thisArg",top:"callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3)",array:"typeof length == 'number'",keys:keys,loop:"if (callback(iterable[index], index, collection) === false) return result"},defaultsIteratorOptions={args:"object, source, guard",top:"var args = arguments,\n    argsIndex = 0,\n    argsLength = typeof guard == 'number' ? 2 : args.length;\nwhile (++argsIndex < argsLength) {\n  iterable = args[argsIndex];\n  if (iterable && objectTypes[typeof iterable]) {",keys:keys,loop:"if (typeof result[index] == 'undefined') result[index] = iterable[index]",bottom:"  }\n}"},forOwnIteratorOptions={top:"if (!objectTypes[typeof iterable]) return result;\n"+eachIteratorOptions.top,array:!1},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},htmlUnescapes=invert(htmlEscapes),reEscapedHtml=RegExp("("+keys(htmlUnescapes).join("|")+")","g"),reUnescapedHtml=RegExp("["+keys(htmlEscapes).join("")+"]","g"),baseEach=createIterator(eachIteratorOptions),assign=createIterator(defaultsIteratorOptions,{top:defaultsIteratorOptions.top.replace(";",";\nif (argsLength > 3 && typeof args[argsLength - 2] == 'function') {\n  var callback = baseCreateCallback(args[--argsLength - 1], args[argsLength--], 2);\n} else if (argsLength > 2 && typeof args[argsLength - 1] == 'function') {\n  callback = args[--argsLength];\n}"),loop:"result[index] = callback ? callback(result[index], iterable[index]) : iterable[index]"}),defaults=createIterator(defaultsIteratorOptions),forIn=createIterator(eachIteratorOptions,forOwnIteratorOptions,{useHas:!1}),forOwn=createIterator(eachIteratorOptions,forOwnIteratorOptions);isFunction(/x/)&&(isFunction=function(value){return"function"==typeof value&&toString.call(value)==funcClass});var isPlainObject=getPrototypeOf?function(value){if(!value||toString.call(value)!=objectClass||!support.argsClass&&isArguments(value))return!1;var valueOf=value.valueOf,objProto=isNative(valueOf)&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?value==objProto||getPrototypeOf(value)==objProto:shimIsPlainObject(value)}:shimIsPlainObject,countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key]++:result[key]=1}),groupBy=createAggregator(function(result,value,key){(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)}),indexBy=createAggregator(function(result,value,key){result[key]=value}),pluck=map,where=filter,now=isNative(now=Date.now)&&now||function(){return(new Date).getTime()},parseInt=8==nativeParseInt(whitespace+"08")?nativeParseInt:function(value,radix){return nativeParseInt(isString(value)?value.replace(reLeadingSpacesAndZeros,""):value,radix||0)};return lodash.after=after,lodash.assign=assign,lodash.at=at,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.chain=chain,lodash.compact=compact,lodash.compose=compose,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.createCallback=createCallback,lodash.curry=curry,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.filter=filter,lodash.flatten=flatten,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.functions=functions,lodash.groupBy=groupBy,lodash.indexBy=indexBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.map=map,lodash.mapValues=mapValues,lodash.max=max,lodash.memoize=memoize,lodash.merge=merge,lodash.min=min,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.pick=pick,lodash.pluck=pluck,lodash.property=property,lodash.pull=pull,lodash.range=range,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.shuffle=shuffle,lodash.sortBy=sortBy,lodash.tap=tap,lodash.throttle=throttle,lodash.times=times,lodash.toArray=toArray,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.values=values,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=zip,lodash.zipObject=zipObject,lodash.collect=map,lodash.drop=rest,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.extend=assign,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,lodash.unzip=zip,mixin(lodash),lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.contains=contains,lodash.escape=escape,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.has=has,lodash.identity=identity,lodash.indexOf=indexOf,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isNaN=isNaN,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isUndefined=isUndefined,lodash.lastIndexOf=lastIndexOf,lodash.mixin=mixin,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.result=result,lodash.runInContext=runInContext,lodash.size=size,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.template=template,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.all=every,lodash.any=some,lodash.detect=find,lodash.findWhere=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.include=contains,lodash.inject=reduce,mixin(function(){var source={};return forOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(source[methodName]=func)}),source}(),!1),lodash.first=first,lodash.last=last,lodash.sample=sample,lodash.take=first,lodash.head=first,forOwn(lodash,function(func,methodName){var callbackable="sample"!==methodName;lodash.prototype[methodName]||(lodash.prototype[methodName]=function(n,guard){var chainAll=this.__chain__,result=func(this.__wrapped__,n,guard);return chainAll||null!=n&&(!guard||callbackable&&"function"==typeof n)?new lodashWrapper(result,chainAll):result})}),lodash.VERSION="2.4.1",lodash.prototype.chain=wrapperChain,lodash.prototype.toString=wrapperToString,lodash.prototype.value=wrapperValueOf,lodash.prototype.valueOf=wrapperValueOf,baseEach(["join","pop","shift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){var chainAll=this.__chain__,result=func.apply(this.__wrapped__,arguments);return chainAll?new lodashWrapper(result,chainAll):result}}),baseEach(["push","reverse","sort","unshift"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return func.apply(this.__wrapped__,arguments),this}}),baseEach(["concat","slice","splice"],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodashWrapper(func.apply(this.__wrapped__,arguments),this.__chain__)}}),support.spliceObjects||baseEach(["pop","shift","splice"],function(methodName){var func=arrayRef[methodName],isSplice="splice"==methodName;lodash.prototype[methodName]=function(){var chainAll=this.__chain__,value=this.__wrapped__,result=func.apply(value,arguments);return 0===value.length&&delete value[0],chainAll||isSplice?new lodashWrapper(result,chainAll):result}}),lodash}var undefined,arrayPool=[],objectPool=[],idCounter=0,indicatorObject={},keyPrefix=+new Date+"",largeArraySize=75,maxPoolSize=40,whitespace=" 	\f\n\r\u2028\u2029",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reFuncName=/^\s*function[ \n\r\t]+\w/,reInterpolate=/<%=([\s\S]+?)%>/g,reLeadingSpacesAndZeros=RegExp("^["+whitespace+"]*0+(?=.$)"),reNoMatch=/($^)/,reThis=/\bthis\b/,reUnescapedString=/['\n\r\t\u2028\u2029\\]/g,contextProps=["Array","Boolean","Date","Error","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],shadowedProps=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],templateCounter=0,argsClass="[object Arguments]",arrayClass="[object Array]",boolClass="[object Boolean]",dateClass="[object Date]",errorClass="[object Error]",funcClass="[object Function]",numberClass="[object Number]",objectClass="[object Object]",regexpClass="[object RegExp]",stringClass="[object String]",cloneableClasses={};cloneableClasses[funcClass]=!1,cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=!0;var debounceOptions={leading:!1,maxWait:0,trailing:!1},descriptor={configurable:!1,enumerable:!1,value:null,writable:!1},iteratorData={args:"",array:null,bottom:"",firstArg:"",init:"",keys:null,loop:"",shadowedProps:null,support:null,top:"",useHas:!1},objectTypes={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},root=objectTypes[typeof window]&&window||this,freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports,freeGlobal=objectTypes[typeof global]&&global;!freeGlobal||freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal||(root=freeGlobal);var _=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeExports&&freeModule?moduleExports?(freeModule.exports=_)._=_:freeExports._=_:root._=_}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(require,module){function EventEmitter(){this._listeners={}}var pull=require("./../../lodash-amd/modern/arrays/pull");EventEmitter.prototype.on=function(eventName,fn){var listeners=this._listeners[eventName]||[];listeners.push(fn),this._listeners[eventName]=listeners},EventEmitter.prototype.off=function(eventName,fn){var listeners=this._listeners[eventName]||[];fn?pull(listeners,fn):delete this._listeners[eventName]},EventEmitter.prototype.trigger=function(eventName,args){var listeners=this._listeners[eventName]||[];listeners.forEach(function(listener){listener.apply(null,args)})},module.exports=EventEmitter},{"./../../lodash-amd/modern/arrays/pull":1}],4:[function(){},{}],5:[function(require,module){module.exports="function"==typeof Object.create?function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],6:[function(require,module){function noop(){}var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(){throw new Error("process.chdir is not supported")}},{}],7:[function(require,module){module.exports=function(arg){return arg&&"object"==typeof arg&&"function"==typeof arg.copy&&"function"==typeof arg.fill&&"function"==typeof arg.readUInt8}},{}],8:[function(require,module,exports){(function(process,global){function inspect(obj,opts){var ctx={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(ctx.depth=arguments[2]),arguments.length>=4&&(ctx.colors=arguments[3]),isBoolean(opts)?ctx.showHidden=opts:opts&&exports._extend(ctx,opts),isUndefined(ctx.showHidden)&&(ctx.showHidden=!1),isUndefined(ctx.depth)&&(ctx.depth=2),isUndefined(ctx.colors)&&(ctx.colors=!1),isUndefined(ctx.customInspect)&&(ctx.customInspect=!0),ctx.colors&&(ctx.stylize=stylizeWithColor),formatValue(ctx,obj,ctx.depth)
}function stylizeWithColor(str,styleType){var style=inspect.styles[styleType];return style?"["+inspect.colors[style][0]+"m"+str+"["+inspect.colors[style][1]+"m":str}function stylizeNoColor(str){return str}function arrayToHash(array){var hash={};return array.forEach(function(val){hash[val]=!0}),hash}function formatValue(ctx,value,recurseTimes){if(ctx.customInspect&&value&&isFunction(value.inspect)&&value.inspect!==exports.inspect&&(!value.constructor||value.constructor.prototype!==value)){var ret=value.inspect(recurseTimes,ctx);return isString(ret)||(ret=formatValue(ctx,ret,recurseTimes)),ret}var primitive=formatPrimitive(ctx,value);if(primitive)return primitive;var keys=Object.keys(value),visibleKeys=arrayToHash(keys);if(ctx.showHidden&&(keys=Object.getOwnPropertyNames(value)),isError(value)&&(keys.indexOf("message")>=0||keys.indexOf("description")>=0))return formatError(value);if(0===keys.length){if(isFunction(value)){var name=value.name?": "+value.name:"";return ctx.stylize("[Function"+name+"]","special")}if(isRegExp(value))return ctx.stylize(RegExp.prototype.toString.call(value),"regexp");if(isDate(value))return ctx.stylize(Date.prototype.toString.call(value),"date");if(isError(value))return formatError(value)}var base="",array=!1,braces=["{","}"];if(isArray(value)&&(array=!0,braces=["[","]"]),isFunction(value)){var n=value.name?": "+value.name:"";base=" [Function"+n+"]"}if(isRegExp(value)&&(base=" "+RegExp.prototype.toString.call(value)),isDate(value)&&(base=" "+Date.prototype.toUTCString.call(value)),isError(value)&&(base=" "+formatError(value)),0===keys.length&&(!array||0==value.length))return braces[0]+base+braces[1];if(0>recurseTimes)return isRegExp(value)?ctx.stylize(RegExp.prototype.toString.call(value),"regexp"):ctx.stylize("[Object]","special");ctx.seen.push(value);var output;return output=array?formatArray(ctx,value,recurseTimes,visibleKeys,keys):keys.map(function(key){return formatProperty(ctx,value,recurseTimes,visibleKeys,key,array)}),ctx.seen.pop(),reduceToSingleString(output,base,braces)}function formatPrimitive(ctx,value){if(isUndefined(value))return ctx.stylize("undefined","undefined");if(isString(value)){var simple="'"+JSON.stringify(value).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ctx.stylize(simple,"string")}return isNumber(value)?ctx.stylize(""+value,"number"):isBoolean(value)?ctx.stylize(""+value,"boolean"):isNull(value)?ctx.stylize("null","null"):void 0}function formatError(value){return"["+Error.prototype.toString.call(value)+"]"}function formatArray(ctx,value,recurseTimes,visibleKeys,keys){for(var output=[],i=0,l=value.length;l>i;++i)output.push(hasOwnProperty(value,String(i))?formatProperty(ctx,value,recurseTimes,visibleKeys,String(i),!0):"");return keys.forEach(function(key){key.match(/^\d+$/)||output.push(formatProperty(ctx,value,recurseTimes,visibleKeys,key,!0))}),output}function formatProperty(ctx,value,recurseTimes,visibleKeys,key,array){var name,str,desc;if(desc=Object.getOwnPropertyDescriptor(value,key)||{value:value[key]},desc.get?str=desc.set?ctx.stylize("[Getter/Setter]","special"):ctx.stylize("[Getter]","special"):desc.set&&(str=ctx.stylize("[Setter]","special")),hasOwnProperty(visibleKeys,key)||(name="["+key+"]"),str||(ctx.seen.indexOf(desc.value)<0?(str=isNull(recurseTimes)?formatValue(ctx,desc.value,null):formatValue(ctx,desc.value,recurseTimes-1),str.indexOf("\n")>-1&&(str=array?str.split("\n").map(function(line){return"  "+line}).join("\n").substr(2):"\n"+str.split("\n").map(function(line){return"   "+line}).join("\n"))):str=ctx.stylize("[Circular]","special")),isUndefined(name)){if(array&&key.match(/^\d+$/))return str;name=JSON.stringify(""+key),name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(name=name.substr(1,name.length-2),name=ctx.stylize(name,"name")):(name=name.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),name=ctx.stylize(name,"string"))}return name+": "+str}function reduceToSingleString(output,base,braces){var numLinesEst=0,length=output.reduce(function(prev,cur){return numLinesEst++,cur.indexOf("\n")>=0&&numLinesEst++,prev+cur.replace(/\u001b\[\d\d?m/g,"").length+1},0);return length>60?braces[0]+(""===base?"":base+"\n ")+" "+output.join(",\n  ")+" "+braces[1]:braces[0]+base+" "+output.join(", ")+" "+braces[1]}function isArray(ar){return Array.isArray(ar)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return isObject(re)&&"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return isObject(d)&&"[object Date]"===objectToString(d)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}function pad(n){return 10>n?"0"+n.toString(10):n.toString(10)}function timestamp(){var d=new Date,time=[pad(d.getHours()),pad(d.getMinutes()),pad(d.getSeconds())].join(":");return[d.getDate(),months[d.getMonth()],time].join(" ")}function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}var formatRegExp=/%[sdj%]/g;exports.format=function(f){if(!isString(f)){for(var objects=[],i=0;i<arguments.length;i++)objects.push(inspect(arguments[i]));return objects.join(" ")}for(var i=1,args=arguments,len=args.length,str=String(f).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case"%s":return String(args[i++]);case"%d":return Number(args[i++]);case"%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}),x=args[i];len>i;x=args[++i])str+=isNull(x)||!isObject(x)?" "+x:" "+inspect(x);return str},exports.deprecate=function(fn,msg){function deprecated(){if(!warned){if(process.throwDeprecation)throw new Error(msg);process.traceDeprecation?console.trace(msg):console.error(msg),warned=!0}return fn.apply(this,arguments)}if(isUndefined(global.process))return function(){return exports.deprecate(fn,msg).apply(this,arguments)};if(process.noDeprecation===!0)return fn;var warned=!1;return deprecated};var debugEnviron,debugs={};exports.debuglog=function(set){if(isUndefined(debugEnviron)&&(debugEnviron=process.env.NODE_DEBUG||""),set=set.toUpperCase(),!debugs[set])if(new RegExp("\\b"+set+"\\b","i").test(debugEnviron)){var pid=process.pid;debugs[set]=function(){var msg=exports.format.apply(exports,arguments);console.error("%s %d: %s",set,pid,msg)}}else debugs[set]=function(){};return debugs[set]},exports.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=require("./support/isBuffer");var months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];exports.log=function(){console.log("%s - %s",timestamp(),exports.format.apply(exports,arguments))},exports.inherits=require("inherits"),exports._extend=function(origin,add){if(!add||!isObject(add))return origin;for(var keys=Object.keys(add),i=keys.length;i--;)origin[keys[i]]=add[keys[i]];return origin}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":7,_process:6,inherits:5}],9:[function(require,module){function createVNode(domNode,key){return key=key||null,1==domNode.nodeType?createFromElement(domNode,key):3==domNode.nodeType?createFromTextNode(domNode,key):void 0}function createFromTextNode(tNode){return new VText(tNode.nodeValue)}function createFromElement(el){for(var tagName=el.tagName,namespace="http://www.w3.org/1999/xhtml"==el.namespaceURI?null:el.namespaceURI,properties=getElementProperties(el),children=[],i=0;i<el.childNodes.length;i++)children.push(createVNode(el.childNodes[i]));return new VNode(tagName,properties,children,null,namespace)}function getElementProperties(el){var obj={};return props.forEach(function(propName){if(el[propName]){if("style"==propName){for(var styleProp,css={},i=0;i<el.style;i++)styleProp=el.style[i],css[styleProp]=el.style.getPropertyValue(styleProp);return void(obj[propName]=css)}if("dataset"==propName){var data={};for(var p in el.dataset)data[p]=el.dataset[p];return void(obj[propName]=data)}"attributes"!=propName&&(obj[propName]=el[propName])}}),obj}var VNode=require("vtree/vnode"),VText=require("vtree/vtext");module.exports=createVNode,createVNode.fromHTML=function(html,key){var domNode=document.createElement("div");return domNode.innerHTML=html,domNode=domNode.children[0]||domNode,createVNode(domNode,key)};{var props=module.exports.properties=["accept","accessKey","action","alt","async","autoComplete","autoPlay","cellPadding","cellSpacing","checked","className","colSpan","content","contentEditable","controls","crossOrigin","data","dataset","defer","dir","download","draggable","encType","formNoValidate","href","hrefLang","htmlFor","httpEquiv","icon","id","label","lang","list","loop","max","mediaGroup","method","min","multiple","muted","name","noValidate","pattern","placeholder","poster","preload","radioGroup","readOnly","rel","required","rowSpan","sandbox","scope","scrollLeft","scrolling","scrollTop","selected","span","spellCheck","src","srcDoc","srcSet","start","step","style","tabIndex","target","title","type","value","autoCapitalize","autoCorrect","property","attributes"];module.exports.attrs=["allowFullScreen","allowTransparency","charSet","cols","contextMenu","dateTime","disabled","form","frameBorder","height","hidden","maxLength","role","rows","seamless","size","width","wmode","cx","cy","d","dx","dy","fill","fx","fy","gradientTransform","gradientUnits","offset","points","r","rx","ry","spreadMethod","stopColor","stopOpacity","stroke","strokeLinecap","strokeWidth","textAnchor","transform","version","viewBox","x1","x2","x","y1","y2","y"]}},{"vtree/vnode":14,"vtree/vtext":15}],10:[function(require,module){function isHook(hook){return hook&&"function"==typeof hook.hook&&!hook.hasOwnProperty("hook")}module.exports=isHook},{}],11:[function(require,module){function isVirtualNode(x){return x&&"VirtualNode"===x.type&&x.version===version}var version=require("./version");module.exports=isVirtualNode},{"./version":13}],12:[function(require,module){function isWidget(w){return w&&"Widget"===w.type}module.exports=isWidget},{}],13:[function(require,module){module.exports="1"},{}],14:[function(require,module){function VirtualNode(tagName,properties,children,key,namespace){this.tagName=tagName,this.properties=properties||noProperties,this.children=children||noChildren,this.key=null!=key?String(key):void 0,this.namespace="string"==typeof namespace?namespace:null;var hooks,count=children&&children.length||0,descendants=0,hasWidgets=!1,descendantHooks=!1;for(var propName in properties)if(properties.hasOwnProperty(propName)){var property=properties[propName];isVHook(property)&&(hooks||(hooks={}),hooks[propName]=property)}for(var i=0;count>i;i++){var child=children[i];isVNode(child)?(descendants+=child.count||0,!hasWidgets&&child.hasWidgets&&(hasWidgets=!0),descendantHooks||!child.hooks&&!child.descendantHooks||(descendantHooks=!0)):!hasWidgets&&isWidget(child)&&"function"==typeof child.destroy&&(hasWidgets=!0)}this.count=count+descendants,this.hasWidgets=hasWidgets,this.hooks=hooks,this.descendantHooks=descendantHooks}var version=require("./version"),isVNode=require("./is-vnode"),isWidget=require("./is-widget"),isVHook=require("./is-vhook");module.exports=VirtualNode;var noProperties={},noChildren=[];VirtualNode.prototype.version=version,VirtualNode.prototype.type="VirtualNode"},{"./is-vhook":10,"./is-vnode":11,"./is-widget":12,"./version":13}],15:[function(require,module){function VirtualText(text){this.text=String(text)}var version=require("./version");module.exports=VirtualText,VirtualText.prototype.version=version,VirtualText.prototype.type="VirtualText"},{"./version":13}],16:[function(require,module){var diff=require("vtree/diff");module.exports=diff},{"vtree/diff":49}],17:[function(require,module){function isObject(x){return"object"==typeof x&&null!==x}module.exports=isObject},{}],18:[function(require,module){function applyProperties(node,props,previous){for(var propName in props){var propValue=props[propName];void 0===propValue?removeProperty(node,props,previous,propName):isHook(propValue)?propValue.hook(node,propName,previous?previous[propName]:void 0):isObject(propValue)?patchObject(node,props,previous,propName,propValue):void 0!==propValue&&(node[propName]=propValue)}}function removeProperty(node,props,previous,propName){if(previous){var previousValue=previous[propName];if(!isHook(previousValue))if("attributes"===propName)for(var attrName in previousValue)node.removeAttribute(attrName);else if("style"===propName)for(var i in previousValue)node.style[i]="";else node[propName]="string"==typeof previousValue?"":null}}function patchObject(node,props,previous,propName,propValue){var previousValue=previous?previous[propName]:void 0;if("attributes"!==propName){if(previousValue&&isObject(previousValue)&&getPrototype(previousValue)!==getPrototype(propValue))return void(node[propName]=propValue);isObject(node[propName])||(node[propName]={});var replacer="style"===propName?"":void 0;for(var k in propValue){var value=propValue[k];node[propName][k]=void 0===value?replacer:value}}else for(var attrName in propValue){var attrValue=propValue[attrName];void 0===attrValue?node.removeAttribute(attrName):node.setAttribute(attrName,attrValue)}}function getPrototype(value){return Object.getPrototypeOf?Object.getPrototypeOf(value):value.__proto__?value.__proto__:value.constructor?value.constructor.prototype:void 0}var isObject=require("is-object"),isHook=require("vtree/is-vhook");module.exports=applyProperties},{"is-object":17,"vtree/is-vhook":52}],19:[function(require,module){function createElement(vnode,opts){var doc=opts?opts.document||document:document,warn=opts?opts.warn:null;if(vnode=handleThunk(vnode).a,isWidget(vnode))return vnode.init();if(isVText(vnode))return doc.createTextNode(vnode.text);if(!isVNode(vnode))return warn&&warn("Item is not a valid virtual dom node",vnode),null;var node=null===vnode.namespace?doc.createElement(vnode.tagName):doc.createElementNS(vnode.namespace,vnode.tagName),props=vnode.properties;applyProperties(node,props);for(var children=vnode.children,i=0;i<children.length;i++){var childNode=createElement(children[i],opts);childNode&&node.appendChild(childNode)}return node}var document=require("global/document"),applyProperties=require("./apply-properties"),isVNode=require("vtree/is-vnode"),isVText=require("vtree/is-vtext"),isWidget=require("vtree/is-widget"),handleThunk=require("vtree/handle-thunk");module.exports=createElement},{"./apply-properties":18,"global/document":21,"vtree/handle-thunk":50,"vtree/is-vnode":53,"vtree/is-vtext":54,"vtree/is-widget":55}],20:[function(require,module){function domIndex(rootNode,tree,indices,nodes){return indices&&0!==indices.length?(indices.sort(ascending),recurse(rootNode,tree,indices,nodes,0)):{}}function recurse(rootNode,tree,indices,nodes,rootIndex){if(nodes=nodes||{},rootNode){indexInRange(indices,rootIndex,rootIndex)&&(nodes[rootIndex]=rootNode);var vChildren=tree.children;if(vChildren)for(var childNodes=rootNode.childNodes,i=0;i<tree.children.length;i++){rootIndex+=1;var vChild=vChildren[i]||noChild,nextIndex=rootIndex+(vChild.count||0);indexInRange(indices,rootIndex,nextIndex)&&recurse(childNodes[i],vChild,indices,nodes,rootIndex),rootIndex=nextIndex}}return nodes}function indexInRange(indices,left,right){if(0===indices.length)return!1;for(var currentIndex,currentItem,minIndex=0,maxIndex=indices.length-1;maxIndex>=minIndex;){if(currentIndex=(maxIndex+minIndex)/2>>0,currentItem=indices[currentIndex],minIndex===maxIndex)return currentItem>=left&&right>=currentItem;if(left>currentItem)minIndex=currentIndex+1;else{if(!(currentItem>right))return!0;maxIndex=currentIndex-1}}return!1}function ascending(a,b){return a>b?1:-1}var noChild={};module.exports=domIndex},{}],21:[function(require,module){(function(global){var topLevel="undefined"!=typeof global?global:"undefined"!=typeof window?window:{},minDoc=require("min-document");if("undefined"!=typeof document)module.exports=document;else{var doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"];doccy||(doccy=topLevel["__GLOBAL_DOCUMENT_CACHE@4"]=minDoc),module.exports=doccy}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"min-document":4}],22:[function(require,module){function applyPatch(vpatch,domNode,renderOptions){var type=vpatch.type,vNode=vpatch.vNode,patch=vpatch.patch;switch(type){case VPatch.REMOVE:return removeNode(domNode,vNode);case VPatch.INSERT:return insertNode(domNode,patch,renderOptions);case VPatch.VTEXT:return stringPatch(domNode,vNode,patch,renderOptions);case VPatch.WIDGET:return widgetPatch(domNode,vNode,patch,renderOptions);case VPatch.VNODE:return vNodePatch(domNode,vNode,patch,renderOptions);case VPatch.ORDER:return reorderChildren(domNode,patch),domNode;case VPatch.PROPS:return applyProperties(domNode,patch,vNode.properties),domNode;case VPatch.THUNK:return replaceRoot(domNode,renderOptions.patch(domNode,patch,renderOptions));default:return domNode}}function removeNode(domNode,vNode){var parentNode=domNode.parentNode;return parentNode&&parentNode.removeChild(domNode),destroyWidget(domNode,vNode),null}function insertNode(parentNode,vNode,renderOptions){var newNode=render(vNode,renderOptions);return parentNode&&parentNode.appendChild(newNode),parentNode}function stringPatch(domNode,leftVNode,vText,renderOptions){var newNode;if(3===domNode.nodeType)domNode.replaceData(0,domNode.length,vText.text),newNode=domNode;else{var parentNode=domNode.parentNode;newNode=render(vText,renderOptions),parentNode&&parentNode.replaceChild(newNode,domNode)}return destroyWidget(domNode,leftVNode),newNode}function widgetPatch(domNode,leftVNode,widget,renderOptions){if(updateWidget(leftVNode,widget))return widget.update(leftVNode,domNode)||domNode;var parentNode=domNode.parentNode,newWidget=render(widget,renderOptions);return parentNode&&parentNode.replaceChild(newWidget,domNode),destroyWidget(domNode,leftVNode),newWidget}function vNodePatch(domNode,leftVNode,vNode,renderOptions){var parentNode=domNode.parentNode,newNode=render(vNode,renderOptions);return parentNode&&parentNode.replaceChild(newNode,domNode),destroyWidget(domNode,leftVNode),newNode}function destroyWidget(domNode,w){"function"==typeof w.destroy&&isWidget(w)&&w.destroy(domNode)}function reorderChildren(domNode,bIndex){var i,children=[],childNodes=domNode.childNodes,len=childNodes.length,reverseIndex=bIndex.reverse;for(i=0;len>i;i++)children.push(domNode.childNodes[i]);var move,node,insertNode,insertOffset=0;for(i=0;len>i;i++)move=bIndex[i],void 0!==move&&move!==i&&(reverseIndex[i]>i&&insertOffset++,node=children[move],insertNode=childNodes[i+insertOffset]||null,node!==insertNode&&domNode.insertBefore(node,insertNode),i>move&&insertOffset--),i in bIndex.removes&&insertOffset++}function replaceRoot(oldRoot,newRoot){return oldRoot&&newRoot&&oldRoot!==newRoot&&oldRoot.parentNode&&(console.log(oldRoot),oldRoot.parentNode.replaceChild(newRoot,oldRoot)),newRoot}var applyProperties=require("./apply-properties"),isWidget=require("vtree/is-widget"),VPatch=require("vtree/vpatch"),render=require("./create-element"),updateWidget=require("./update-widget");module.exports=applyPatch},{"./apply-properties":18,"./create-element":19,"./update-widget":24,"vtree/is-widget":55,"vtree/vpatch":59}],23:[function(require,module){function patch(rootNode,patches){return patchRecursive(rootNode,patches)}function patchRecursive(rootNode,patches,renderOptions){var indices=patchIndices(patches);if(0===indices.length)return rootNode;var index=domIndex(rootNode,patches.a,indices),ownerDocument=rootNode.ownerDocument;renderOptions||(renderOptions={patch:patchRecursive},ownerDocument!==document&&(renderOptions.document=ownerDocument));for(var i=0;i<indices.length;i++){var nodeIndex=indices[i];rootNode=applyPatch(rootNode,index[nodeIndex],patches[nodeIndex],renderOptions)}return rootNode}function applyPatch(rootNode,domNode,patchList,renderOptions){if(!domNode)return rootNode;var newNode;if(isArray(patchList))for(var i=0;i<patchList.length;i++)newNode=patchOp(patchList[i],domNode,renderOptions),domNode===rootNode&&(rootNode=newNode);else newNode=patchOp(patchList,domNode,renderOptions),domNode===rootNode&&(rootNode=newNode);return rootNode}function patchIndices(patches){var indices=[];for(var key in patches)"a"!==key&&indices.push(Number(key));return indices}var document=require("global/document"),isArray=require("x-is-array"),domIndex=require("./dom-index"),patchOp=require("./patch-op");module.exports=patch},{"./dom-index":20,"./patch-op":22,"global/document":21,"x-is-array":25}],24:[function(require,module){function updateWidget(a,b){return isWidget(a)&&isWidget(b)?"name"in a&&"name"in b?a.id===b.id:a.init===b.init:!1}var isWidget=require("vtree/is-widget");module.exports=updateWidget},{"vtree/is-widget":55}],25:[function(require,module){function isArray(obj){return"[object Array]"===toString.call(obj)}var nativeIsArray=Array.isArray,toString=Object.prototype.toString;module.exports=nativeIsArray||isArray},{}],26:[function(require,module){var patch=require("vdom/patch");module.exports=patch},{"vdom/patch":23}],27:[function(require,module){function DataSetHook(value){return this instanceof DataSetHook?void(this.value=value):new DataSetHook(value)}var DataSet=require("data-set");module.exports=DataSetHook,DataSetHook.prototype.hook=function(node,propertyName){var ds=DataSet(node),propName=propertyName.substr(5);ds[propName]=this.value}},{"data-set":32}],28:[function(require,module){function DataSetHook(value){return this instanceof DataSetHook?void(this.value=value):new DataSetHook(value)}var DataSet=require("data-set");module.exports=DataSetHook,DataSetHook.prototype.hook=function(node,propertyName){var ds=DataSet(node),propName=propertyName.substr(3);ds[propName]=this.value}},{"data-set":32}],29:[function(require,module){function SoftSetHook(value){return this instanceof SoftSetHook?void(this.value=value):new SoftSetHook(value)}module.exports=SoftSetHook,SoftSetHook.prototype.hook=function(node,propertyName){node[propertyName]!==this.value&&(node[propertyName]=this.value)}},{}],30:[function(require,module){function h(tagName,properties,children){var tag,props,key,namespace,childNodes=[];!children&&isChildren(properties)&&(children=properties,props={}),props=props||properties||{},tag=parseTag(tagName,props),"key"in props&&(key=props.key,props.key=void 0),"namespace"in props&&(namespace=props.namespace,props.namespace=void 0),"input"===tag&&"value"in props&&void 0!==props.value&&!isHook(props.value)&&(props.value=softSetHook(props.value));for(var propName,value,keys=Object.keys(props),j=0;j<keys.length;j++)propName=keys[j],value=props[propName],isHook(value)||("data-"===propName.substr(0,5)&&(props[propName]=dataSetHook(value)),"ev-"===propName.substr(0,3)&&(props[propName]=evHook(value)));void 0!==children&&null!==children&&addChild(children,childNodes,tag,props);var node=new VNode(tag,props,childNodes,key,namespace);return node}function addChild(c,childNodes,tag,props){if("string"==typeof c)childNodes.push(new VText(c));else if(isChild(c))childNodes.push(c);else{if(!Array.isArray(c)){if(null===c||void 0===c)return;throw UnexpectedVirtualElement({foreignObjectStr:JSON.stringify(c),foreignObject:c,parentVnodeStr:JSON.stringify({tagName:tag,properties:props}),parentVnode:{tagName:tag,properties:props}})}for(var i=0;i<c.length;i++)addChild(c[i],childNodes,tag,props)}}function isChild(x){return isVNode(x)||isVText(x)||isWidget(x)||isVThunk(x)}function isChildren(x){return"string"==typeof x||Array.isArray(x)||isChild(x)}var VNode=require("vtree/vnode.js"),VText=require("vtree/vtext.js"),isVNode=require("vtree/is-vnode"),isVText=require("vtree/is-vtext"),isWidget=require("vtree/is-widget"),isHook=require("vtree/is-vhook"),isVThunk=require("vtree/is-thunk"),TypedError=require("error/typed"),parseTag=require("./parse-tag.js"),softSetHook=require("./hooks/soft-set-hook.js"),dataSetHook=require("./hooks/data-set-hook.js"),evHook=require("./hooks/ev-hook.js"),UnexpectedVirtualElement=TypedError({type:"virtual-hyperscript.unexpected.virtual-element",message:"Unexpected virtual child passed to h().\nExpected a VNode / Vthunk / VWidget / string but:\ngot a {foreignObjectStr}.\nThe parent vnode is {parentVnodeStr}.\nSuggested fix: change your `h(..., [ ... ])` callsite.",foreignObjectStr:null,parentVnodeStr:null,foreignObject:null,parentVnode:null});module.exports=h},{"./hooks/data-set-hook.js":27,"./hooks/ev-hook.js":28,"./hooks/soft-set-hook.js":29,"./parse-tag.js":48,"error/typed":39,"vtree/is-thunk":40,"vtree/is-vhook":41,"vtree/is-vnode":42,"vtree/is-vtext":43,"vtree/is-widget":44,"vtree/vnode.js":46,"vtree/vtext.js":47}],31:[function(require,module){function createHash(elem){var attributes=elem.attributes,hash={};if(null===attributes||void 0===attributes)return hash;for(var i=0;i<attributes.length;i++){var attr=attributes[i];"data-"===attr.name.substr(0,5)&&(hash[attr.name.substr(5)]=attr.value)}return hash}module.exports=createHash},{}],32:[function(require,module){function DataSet(elem){var store=hashStore(elem);return store.hash||(store.hash=createHash(elem)),store.hash}var createStore=require("weakmap-shim/create-store"),Individual=require("individual"),createHash=require("./create-hash.js"),hashStore=Individual("__DATA_SET_WEAKMAP@3",createStore());module.exports=DataSet},{"./create-hash.js":31,individual:33,"weakmap-shim/create-store":34}],33:[function(require,module){(function(global){function Individual(key,value){return root[key]?root[key]:(Object.defineProperty(root,key,{value:value,configurable:!0}),value)}var root="undefined"!=typeof window?window:"undefined"!=typeof global?global:{};module.exports=Individual}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(require,module){function createStore(){var key={};return function(obj){if("object"!=typeof obj||null===obj)throw new Error("Weakmap-shim: Key must be object");var store=obj.valueOf(key);return store&&store.identity===key?store:hiddenStore(obj,key)}}var hiddenStore=require("./hidden-store.js");module.exports=createStore},{"./hidden-store.js":35}],35:[function(require,module){function hiddenStore(obj,key){var store={identity:key},valueOf=obj.valueOf;return Object.defineProperty(obj,"valueOf",{value:function(value){return value!==key?valueOf.apply(this,arguments):store},writable:!0}),store}module.exports=hiddenStore},{}],36:[function(require,module){function walk(obj){return obj&&"object"==typeof obj?isDate(obj)||isRegex(obj)?obj:isArray(obj)?map(obj,walk):reduce(objectKeys(obj),function(acc,key){var camel=camelCase(key);return acc[camel]=walk(obj[key]),acc},{}):obj}function camelCase(str){return str.replace(/[_.-](\w|$)/g,function(_,x){return x.toUpperCase()})}function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}function reduce(xs,f,acc){if(xs.reduce)return xs.reduce(f,acc);for(var i=0;i<xs.length;i++)acc=f(acc,xs[i],i);return acc}module.exports=function(obj){return"string"==typeof obj?camelCase(obj):walk(obj)};var isArray=Array.isArray||function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},isDate=function(obj){return"[object Date]"===Object.prototype.toString.call(obj)},isRegex=function(obj){return"[object RegExp]"===Object.prototype.toString.call(obj)},has=Object.prototype.hasOwnProperty,objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)has.call(obj,key)&&keys.push(key);return keys}},{}],37:[function(require,module){function template(string){var args;return args=2===arguments.length&&"object"==typeof arguments[1]?arguments[1]:slice.call(arguments,1),args&&args.hasOwnProperty||(args={}),string.replace(nargs,function(match,i,index){var result;return"{"===string[index-1]&&"}"===string[index+match.length]?i:(result=args.hasOwnProperty(i)?args[i]:null,null===result||void 0===result?"":result)})}var nargs=/\{([0-9a-zA-Z]+)\}/g,slice=Array.prototype.slice;module.exports=template},{}],38:[function(require,module){function extend(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)source.hasOwnProperty(key)&&(target[key]=source[key])}return target}module.exports=extend},{}],39:[function(require,module){function TypedError(args){function createError(opts){var result=new Error;Object.defineProperty(result,"type",{value:result.type,enumerable:!0,writable:!0,configurable:!0});var options=extend({},args,opts);return extend(result,options),result.message=template(message,options),result}if(!args)throw new Error("args is required");if(!args.type)throw new Error("args.type is required");if(!args.message)throw new Error("args.message is required");var message=args.message;if(args.type&&!args.name){var errorName=camelize(args.type)+"Error";args.name=errorName[0].toUpperCase()+errorName.substr(1)}return extend(createError,args),createError._name=args.name,createError}var camelize=require("camelize"),template=require("string-template"),extend=require("xtend/mutable");module.exports=TypedError},{camelize:36,"string-template":37,"xtend/mutable":38}],40:[function(require,module){function isThunk(t){return t&&"Thunk"===t.type}module.exports=isThunk},{}],41:[function(require,module){module.exports=require(10)},{"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vhook.js":10}],42:[function(require,module){module.exports=require(11)},{"./version":45,"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vnode.js":11}],43:[function(require,module){function isVirtualText(x){return x&&"VirtualText"===x.type&&x.version===version}var version=require("./version");module.exports=isVirtualText},{"./version":45}],44:[function(require,module){module.exports=require(12)},{"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-widget.js":12}],45:[function(require,module){module.exports=require(13)},{"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/version.js":13}],46:[function(require,module){module.exports=require(14)},{"./is-vhook":41,"./is-vnode":42,"./is-widget":44,"./version":45,"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/vnode.js":14}],47:[function(require,module){module.exports=require(15)},{"./version":45,"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/vtext.js":15}],48:[function(require,module){function parseTag(tag,props){if(!tag)return"div";var noId=!("id"in props),tagParts=tag.split(classIdSplit),tagName=null;notClassId.test(tagParts[1])&&(tagName="div");var classes,part,type,i;
for(i=0;i<tagParts.length;i++)part=tagParts[i],part&&(type=part.charAt(0),tagName?"."===type?(classes=classes||[],classes.push(part.substring(1,part.length))):"#"===type&&noId&&(props.id=part.substring(1,part.length)):tagName=part);return classes&&(props.className&&classes.push(props.className),props.className=classes.join(" ")),tagName?tagName.toLowerCase():"div"}var classIdSplit=/([\.#]?[a-zA-Z0-9_:-]+)/,notClassId=/^\.|#/;module.exports=parseTag},{}],49:[function(require,module){function diff(a,b){var patch={a:a};return walk(a,b,patch,0),patch}function walk(a,b,patch,index){if(a===b)return void(isThunk(a)||isThunk(b)?thunks(a,b,patch,index):hooks(b,patch,index));var apply=patch[index];if(null==b)apply=appendPatch(apply,new VPatch(VPatch.REMOVE,a,b)),destroyWidgets(a,patch,index);else if(isThunk(a)||isThunk(b))thunks(a,b,patch,index);else if(isVNode(b))if(isVNode(a)){if(a.tagName===b.tagName&&a.namespace===b.namespace&&a.key===b.key){var propsPatch=diffProps(a.properties,b.properties,b.hooks);propsPatch&&(apply=appendPatch(apply,new VPatch(VPatch.PROPS,a,propsPatch)))}else apply=appendPatch(apply,new VPatch(VPatch.VNODE,a,b)),destroyWidgets(a,patch,index);apply=diffChildren(a,b,patch,apply,index)}else apply=appendPatch(apply,new VPatch(VPatch.VNODE,a,b)),destroyWidgets(a,patch,index);else isVText(b)?isVText(a)?a.text!==b.text&&(apply=appendPatch(apply,new VPatch(VPatch.VTEXT,a,b))):(apply=appendPatch(apply,new VPatch(VPatch.VTEXT,a,b)),destroyWidgets(a,patch,index)):isWidget(b)&&(apply=appendPatch(apply,new VPatch(VPatch.WIDGET,a,b)),isWidget(a)||destroyWidgets(a,patch,index));apply&&(patch[index]=apply)}function diffProps(a,b,hooks){var diff;for(var aKey in a){aKey in b||(diff=diff||{},diff[aKey]=void 0);var aValue=a[aKey],bValue=b[aKey];if(hooks&&aKey in hooks)diff=diff||{},diff[aKey]=bValue;else if(isObject(aValue)&&isObject(bValue))if(getPrototype(bValue)!==getPrototype(aValue))diff=diff||{},diff[aKey]=bValue;else{var objectDiff=diffProps(aValue,bValue);objectDiff&&(diff=diff||{},diff[aKey]=objectDiff)}else aValue!==bValue&&(diff=diff||{},diff[aKey]=bValue)}for(var bKey in b)bKey in a||(diff=diff||{},diff[bKey]=b[bKey]);return diff}function getPrototype(value){return Object.getPrototypeOf?Object.getPrototypeOf(value):value.__proto__?value.__proto__:value.constructor?value.constructor.prototype:void 0}function diffChildren(a,b,patch,apply,index){for(var aChildren=a.children,bChildren=reorder(aChildren,b.children),aLen=aChildren.length,bLen=bChildren.length,len=aLen>bLen?aLen:bLen,i=0;len>i;i++){var leftNode=aChildren[i],rightNode=bChildren[i];index+=1,leftNode?rightNode?walk(leftNode,rightNode,patch,index):leftNode&&(patch[index]=new VPatch(VPatch.REMOVE,leftNode,null),destroyWidgets(leftNode,patch,index)):rightNode&&(apply=appendPatch(apply,new VPatch(VPatch.INSERT,null,rightNode))),isVNode(leftNode)&&leftNode.count&&(index+=leftNode.count)}return bChildren.moves&&(apply=appendPatch(apply,new VPatch(VPatch.ORDER,a,bChildren.moves))),apply}function destroyWidgets(vNode,patch,index){if(isWidget(vNode))"function"==typeof vNode.destroy&&(patch[index]=new VPatch(VPatch.REMOVE,vNode,null));else if(isVNode(vNode)&&vNode.hasWidgets)for(var children=vNode.children,len=children.length,i=0;len>i;i++){var child=children[i];index+=1,destroyWidgets(child,patch,index),isVNode(child)&&child.count&&(index+=child.count)}}function thunks(a,b,patch,index){var nodes=handleThunk(a,b),thunkPatch=diff(nodes.a,nodes.b);hasPatches(thunkPatch)&&(patch[index]=new VPatch(VPatch.THUNK,null,thunkPatch))}function hasPatches(patch){for(var index in patch)if("a"!==index)return!0;return!1}function hooks(vNode,patch,index){if(isVNode(vNode)&&(vNode.hooks&&(patch[index]=new VPatch(VPatch.PROPS,vNode.hooks,vNode.hooks)),vNode.descendantHooks))for(var children=vNode.children,len=children.length,i=0;len>i;i++){var child=children[i];index+=1,hooks(child,patch,index),isVNode(child)&&child.count&&(index+=child.count)}}function reorder(aChildren,bChildren){var bKeys=keyIndex(bChildren);if(!bKeys)return bChildren;var aKeys=keyIndex(aChildren);if(!aKeys)return bChildren;var bMatch={},aMatch={};for(var key in bKeys)bMatch[bKeys[key]]=aKeys[key];for(var key in aKeys)aMatch[aKeys[key]]=bKeys[key];for(var aLen=aChildren.length,bLen=bChildren.length,len=aLen>bLen?aLen:bLen,shuffle=[],freeIndex=0,i=0,moveIndex=0,moves={},removes=moves.removes={},reverse=moves.reverse={},hasMoves=!1;len>freeIndex;){var move=aMatch[i];if(void 0!==move)shuffle[i]=bChildren[move],move!==moveIndex&&(moves[move]=moveIndex,reverse[moveIndex]=move,hasMoves=!0),moveIndex++;else if(i in aMatch)shuffle[i]=void 0,removes[i]=moveIndex++,hasMoves=!0;else{for(;void 0!==bMatch[freeIndex];)freeIndex++;if(len>freeIndex){var freeChild=bChildren[freeIndex];freeChild&&(shuffle[i]=freeChild,freeIndex!==moveIndex&&(hasMoves=!0,moves[freeIndex]=moveIndex,reverse[moveIndex]=freeIndex),moveIndex++),freeIndex++}}i++}return hasMoves&&(shuffle.moves=moves),shuffle}function keyIndex(children){var i,keys;for(i=0;i<children.length;i++){var child=children[i];void 0!==child.key&&(keys=keys||{},keys[child.key]=i)}return keys}function appendPatch(apply,patch){return apply?(isArray(apply)?apply.push(patch):apply=[apply,patch],apply):patch}var isArray=require("x-is-array"),isObject=require("is-object"),VPatch=require("./vpatch"),isVNode=require("./is-vnode"),isVText=require("./is-vtext"),isWidget=require("./is-widget"),isThunk=require("./is-thunk"),handleThunk=require("./handle-thunk");module.exports=diff},{"./handle-thunk":50,"./is-thunk":51,"./is-vnode":53,"./is-vtext":54,"./is-widget":55,"./vpatch":59,"is-object":56,"x-is-array":57}],50:[function(require,module){function handleThunk(a,b){var renderedA=a,renderedB=b;return isThunk(b)&&(renderedB=renderThunk(b,a)),isThunk(a)&&(renderedA=renderThunk(a,null)),{a:renderedA,b:renderedB}}function renderThunk(thunk,previous){var renderedThunk=thunk.vnode;if(renderedThunk||(renderedThunk=thunk.vnode=thunk.render(previous)),!(isVNode(renderedThunk)||isVText(renderedThunk)||isWidget(renderedThunk)))throw new Error("thunk did not return a valid node");return renderedThunk}var isVNode=require("./is-vnode"),isVText=require("./is-vtext"),isWidget=require("./is-widget"),isThunk=require("./is-thunk");module.exports=handleThunk},{"./is-thunk":51,"./is-vnode":53,"./is-vtext":54,"./is-widget":55}],51:[function(require,module){module.exports=require(40)},{"/web/scribe-plugin-noting/node_modules/virtual-hyperscript/node_modules/vtree/is-thunk.js":40}],52:[function(require,module){module.exports=require(10)},{"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vhook.js":10}],53:[function(require,module){module.exports=require(11)},{"./version":58,"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-vnode.js":11}],54:[function(require,module){module.exports=require(43)},{"./version":58,"/web/scribe-plugin-noting/node_modules/virtual-hyperscript/node_modules/vtree/is-vtext.js":43}],55:[function(require,module){module.exports=require(12)},{"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/is-widget.js":12}],56:[function(require,module){module.exports=require(17)},{"/web/scribe-plugin-noting/node_modules/virtual-dom/node_modules/is-object/index.js":17}],57:[function(require,module){module.exports=require(25)},{"/web/scribe-plugin-noting/node_modules/virtual-dom/node_modules/x-is-array/index.js":25}],58:[function(require,module){module.exports=require(13)},{"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/version.js":13}],59:[function(require,module){function VirtualPatch(type,vNode,patch){this.type=Number(type),this.vNode=vNode,this.patch=patch}var version=require("./version");VirtualPatch.NONE=0,VirtualPatch.VTEXT=1,VirtualPatch.VNODE=2,VirtualPatch.WIDGET=3,VirtualPatch.PROPS=4,VirtualPatch.ORDER=5,VirtualPatch.INSERT=6,VirtualPatch.REMOVE=7,VirtualPatch.THUNK=8,module.exports=VirtualPatch,VirtualPatch.prototype.version=version,VirtualPatch.prototype.type="VirtualPatch"},{"./version":58}],60:[function(require,module){module.exports=require(15)},{"./version":58,"/web/scribe-plugin-noting/node_modules/vdom-virtualize/node_modules/vtree/vtext.js":15}],61:[function(require,module){"use strict";var generateNoteController=require("./src/generate-note-controller");module.exports=function(config){return function(scribe){generateNoteController(scribe,config)}}},{"./src/generate-note-controller":83}],62:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),getNoteDataAttributes=require("../../utils/get-note-data-attrs"),createVirtualScribeMarker=require("../../utils/create-virtual-scribe-marker"),wrapInNote=require("./wrap-in-note"),findScribeMarkers=require("../../utils/noting/find-scribe-markers"),findEntireNote=require("../../utils/noting/find-entire-note"),resetNoteSegmentClasses=require("./reset-note-segment-classes"),errorHandle=require("../../utils/error-handle"),zeroWidthSpace="";module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to createNoteAtCaret, you passed: %s",focus);var note=wrapInNote([zeroWidthSpace,createVirtualScribeMarker()],getNoteDataAttributes()),marker=findScribeMarkers(focus)[0];marker||errorHandle("No scribe marker found within selection: %s",focus),marker.replace(note);var noteSegments=findEntireNote(marker);return resetNoteSegmentClasses(noteSegments),focus}},{"../../utils/create-virtual-scribe-marker":88,"../../utils/error-handle":90,"../../utils/get-note-data-attrs":92,"../../utils/noting/find-entire-note":97,"../../utils/noting/find-scribe-markers":102,"../../utils/vfocus/is-vfocus":125,"./reset-note-segment-classes":72,"./wrap-in-note":77}],63:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),VText=require("vtree/vtext"),isVFocus=require("../../utils/vfocus/is-vfocus"),errorHandle=require("../../utils/error-handle"),findTextBetweenScribeMarkers=require("../../utils/noting/find-text-between-scribe-markers"),getNoteDataAttributes=require("../../utils/get-note-data-attrs"),wrapInNote=require("./wrap-in-note"),removeErroneousBrTags=require("./remove-erroneous-br-tags"),removeScribeMarkers=require("./remove-scribe-markers"),findLastNoteSegment=require("../../utils/noting/find-last-note-segment"),findEntireNote=require("../../utils/noting/find-entire-note"),resetNoteSegmentClasses=require("./reset-note-segment-classes"),notesCache=require("../../utils/noting/note-cache"),isNotWithinNote=require("../../utils/noting/is-not-within-note"),isParagraph=require("../../utils/vfocus/is-paragraph"),createVirtualScribeMarker=require("../../utils/create-virtual-scribe-marker"),isNotEmpty=require("../../utils/vfocus/is-not-empty"),removeEmptyNotes=require("../../actions/noting/remove-empty-notes");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus element can be passed to createNoteFromSelection, you passed: %s",focus);var toWrapAndReplace=findTextBetweenScribeMarkers(focus).filter(isNotWithinNote),noteDataSet=getNoteDataAttributes(),wrappedTextNodes=toWrapAndReplace.map(function(focus){return wrapInNote(focus.vNode,noteDataSet)});_.zip(toWrapAndReplace,wrappedTextNodes).forEach(function(focusAndReplacementVNode){var focus=focusAndReplacementVNode[0],replacementVNode=focusAndReplacementVNode[1];focus.replace(replacementVNode)}),removeErroneousBrTags(focus),removeScribeMarkers(focus);var lastNoteSegment=findLastNoteSegment(toWrapAndReplace[0]),noteSegments=findEntireNote(lastNoteSegment);resetNoteSegmentClasses(noteSegments),notesCache.set(focus);var outsideNoteFocus=noteSegments.splice(-1)[0].find(isNotWithinNote);if(outsideNoteFocus)if(isParagraph(outsideNoteFocus))outsideNoteFocus.insertBefore([new VText(""),createVirtualScribeMarker()]);else{var firstNodeWithChildren=outsideNoteFocus.find(isNotEmpty);firstNodeWithChildren&&firstNodeWithChildren.insertBefore(createVirtualScribeMarker())}return removeEmptyNotes(focus),focus}},{"../../actions/noting/remove-empty-notes":66,"../../utils/create-virtual-scribe-marker":88,"../../utils/error-handle":90,"../../utils/get-note-data-attrs":92,"../../utils/noting/find-entire-note":97,"../../utils/noting/find-last-note-segment":99,"../../utils/noting/find-text-between-scribe-markers":104,"../../utils/noting/is-not-within-note":107,"../../utils/noting/note-cache":112,"../../utils/vfocus/is-not-empty":123,"../../utils/vfocus/is-paragraph":124,"../../utils/vfocus/is-vfocus":125,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"./remove-erroneous-br-tags":67,"./remove-scribe-markers":70,"./reset-note-segment-classes":72,"./wrap-in-note":77,"vtree/vtext":60}],64:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),noteCache=(require("../../utils/error-handle"),require("../../utils/noting/note-cache")),mergeIfNecessary=require("./merge-if-necessary"),resetNoteBarriers=require("./reset-note-barriers"),removeErroneousBrTags=require("./remove-erroneous-br-tags");module.exports=function(focus){isVFocus(focus)||errorhandle("Only a valid VFocus element can be passed to ensureNoteIntegrity, you passed: %s",focus),noteCache.set(focus),mergeIfNecessary(focus),resetNoteBarriers(focus),removeErroneousBrTags(focus)}},{"../../utils/error-handle":90,"../../utils/noting/note-cache":112,"../../utils/vfocus/is-vfocus":125,"./merge-if-necessary":65,"./remove-erroneous-br-tags":67,"./reset-note-barriers":71}],65:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../../utils/vfocus/is-vfocus"),errorHandle=require("../../utils/error-handle"),findAllNotes=require("../../utils/noting/find-all-notes"),resetNoteSegmentClasses=require("./reset-note-segment-classes");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to mergeIfNecessary, you pased: %s",focus),findAllNotes(focus).filter(function(note){var inconsistentTimeStamps=_(note).map(function(segment){return!!segment.vNode.properties.dataset.noteEditedBy}).uniq().value();if(inconsistentTimeStamps.length>1)return!0;var hasNoteStart="noteStart"in note[0].vNode.properties.dataset,hasNoteEnd="noteEnd"in note[note.length-1].vNode.properties.dataset;return!(hasNoteStart&&hasNoteEnd)}).forEach(function(note){resetNoteSegmentClasses(note)})}},{"../../utils/error-handle":90,"../../utils/noting/find-all-notes":95,"../../utils/vfocus/is-vfocus":125,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"./reset-note-segment-classes":72}],66:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../../utils/vfocus/is-vfocus"),isEmpty=(require("../../utils/vfocus/is-vtext"),require("../../utils/vfocus/is-empty")),findAllNotes=require("../../utils/noting/find-all-notes"),flattenTree=require("../../utils/vfocus/flatten-tree"),errorHandle=require("../../utils/error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to removeEmptyNotes, you passed: %s",focus);var allNoteSegments=_.flatten(findAllNotes(focus)),noteSequences=allNoteSegments.map(flattenTree);noteSequences.forEach(function(noteSequence){var noteParent=noteSequence.splice(0,1)[0];if(noteSequence.length<=0)return void noteParent.remove();var childrenAreEmpty=noteSequence.reduce(function(check,childFocus){return isEmpty(childFocus)?!0:!1},!0);childrenAreEmpty&&noteParent.remove()})}},{"../../utils/error-handle":90,"../../utils/noting/find-all-notes":95,"../../utils/vfocus/flatten-tree":119,"../../utils/vfocus/is-empty":122,"../../utils/vfocus/is-vfocus":125,"../../utils/vfocus/is-vtext":126,"./../../../bower_components/lodash/dist/lodash.compat.js":2}],67:[function(require,module){"use strict";var VText=require("vtree/vtext"),isVFocus=require("../../utils/vfocus/is-vfocus"),isVText=require("../../utils/vfocus/is-vtext"),errorHandle=require("../../utils/error-handle"),findScribeMarkers=require("../../utils/noting/find-scribe-markers"),isNoteSegment=require("../../utils/noting/is-note-segment"),hasOnlyEmptyTextChildren=require("../../utils/vfocus/has-only-empty-text-children"),hasNoTextChildren=require("../../utils/vfocus/has-no-text-children");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus element can be passed to preventBrTags, you passsed: %s",focus);var markers=findScribeMarkers(focus);if(2!==markers.length&&markers[0]){var marker=markers[0],segments=[marker.find(isNoteSegment,"prev"),marker.find(isNoteSegment)].filter(function(o){return!!o});segments.map(function(segment){if(hasOnlyEmptyTextChildren(segment)){var prevNoteSegment=segment.prev().find(isNoteSegment,"prev");if(prevNoteSegment){var lastTextNode=prevNoteSegment.vNode.children.filter(isVText).slice(-1)[0];lastTextNode&&(lastTextNode.text=lastTextNode.text+" ")}}if(hasNoTextChildren(segment)||hasOnlyEmptyTextChildren(segment))for(var replaced=segment.replace(new VText(""));replaced;)replaced.canDown()||replaced.remove(),replaced=replaced.up()})}}},{"../../utils/error-handle":90,"../../utils/noting/find-scribe-markers":102,"../../utils/noting/is-note-segment":108,"../../utils/vfocus/has-no-text-children":120,"../../utils/vfocus/has-only-empty-text-children":121,"../../utils/vfocus/is-vfocus":125,"../../utils/vfocus/is-vtext":126,"vtree/vtext":60}],68:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),errorHandle=require("../../utils/error-handle"),findScribeMarkers=require("../../utils/noting/find-scribe-markers"),noteCache=require("../../utils/noting/note-cache"),findParentNoteSegment=require("../../utils/noting/find-parent-note-segment"),findNoteById=require("../../utils/noting/find-note-by-id"),unWrapNote=require("./unwrap-note"),ensureNoteIntegrity=require("./ensure-note-integrity");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus element can be passed to removeNote, you passed: %s",focus);var marker=findScribeMarkers(focus)[0];noteCache.set(focus);var noteSegment=findParentNoteSegment(marker),noteSegments=findNoteById(focus,noteSegment.vNode.properties.dataset.noteId);return noteSegments.forEach(unWrapNote),ensureNoteIntegrity(focus),focus}},{"../../utils/error-handle":90,"../../utils/noting/find-note-by-id":100,"../../utils/noting/find-parent-note-segment":101,"../../utils/noting/find-scribe-markers":102,"../../utils/noting/note-cache":112,"../../utils/vfocus/is-vfocus":125,"./ensure-note-integrity":64,"./unwrap-note":76}],69:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),VText=require("vtree/vtext"),isVFocus=require("../../utils/vfocus/is-vfocus"),errorHandle=require("../../utils/error-handle"),findTextBetweenScribeMarkers=require("../../utils/noting/find-text-between-scribe-markers"),findEntireNote=require("../../utils/noting/find-entire-note"),flattenTree=require("../../utils/vfocus/flatten-tree"),isVText=require("../../utils/vfocus/is-vtext"),getNoteDataAttribs=require("../../utils/get-note-data-attrs"),wrapInNote=require("./wrap-in-note"),unWrapNote=require("./unwrap-note"),ensureNoteIntegrity=require("./ensure-note-integrity"),findScribeMarkers=require("../../utils/noting/find-scribe-markers"),removeEmptyNotes=require("./remove-empty-notes");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to unNotePartOfNote, you passed: %s",focus);var focusesToUnnote=findTextBetweenScribeMarkers(focus),entireNote=findEntireNote(focusesToUnnote[0]),entireNoteTextNodeFocuses=_(entireNote).map(flattenTree).flatten().value().filter(isVText),entireNoteTextNodes=entireNoteTextNodeFocuses.map(function(nodeFocus){return nodeFocus.vNode}),textNodesToUnote=focusesToUnnote.map(function(nodeFocus){return nodeFocus.vNode}),toWrapAndReplace=_.difference(entireNoteTextNodes,textNodesToUnote),focusesToNote=entireNoteTextNodeFocuses.filter(function(nodeFocus){return-1===textNodesToUnote.indexOf(nodeFocus.vNode)}),noteData=getNoteDataAttribs(),wrappedTextNodes=toWrapAndReplace.map(function(nodeFocus){return wrapInNote(nodeFocus,noteData)});_.zip(focusesToNote,wrappedTextNodes).forEach(function(node){return node[0].replace(node[1])}),entireNote.forEach(unWrapNote);var onlyPartOfContentsSelected=focusesToNote[0];onlyPartOfContentsSelected&&ensureNoteIntegrity(onlyPartOfContentsSelected.top());var markers=findScribeMarkers(focus.refresh());return markers.splice(-1)[0].insertAfter(new VText("")),markers[0].remove(),removeEmptyNotes(focus.refresh()),focus}},{"../../utils/error-handle":90,"../../utils/get-note-data-attrs":92,"../../utils/noting/find-entire-note":97,"../../utils/noting/find-scribe-markers":102,"../../utils/noting/find-text-between-scribe-markers":104,"../../utils/vfocus/flatten-tree":119,"../../utils/vfocus/is-vfocus":125,"../../utils/vfocus/is-vtext":126,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"./ensure-note-integrity":64,"./remove-empty-notes":66,"./unwrap-note":76,"./wrap-in-note":77,"vtree/vtext":60}],70:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),isScribeMarker=require("../../utils/noting/is-scribe-marker"),errorHandle=require("../../utils/error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to removeScribeMarkers, you passed: %s",focus),focus.filter(isScribeMarker).forEach(function(marker){marker.remove()})}},{"../../utils/error-handle":90,"../../utils/noting/is-scribe-marker":109,"../../utils/vfocus/is-vfocus":125}],71:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),isVText=require("../../utils/vfocus/is-vtext"),findAllNotes=require("../../utils/noting/find-all-notes"),createNoteBarrier=require("../../utils/create-note-barrier"),isNotWithinNote=require("../../utils/noting/is-not-within-note"),isNotEmpty=require("../../utils/vfocus/is-not-empty"),errorHandle=require("../../utils/error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus element can be passed to resetNoteBarriers, you passed: ",focus),focus.filter(isVText).forEach(function(focus){focus.vNode.text=focus.vNode.text.replace(/\u200B/g,"")}),findAllNotes(focus).forEach(function(noteSegments){noteSegments[0].next().insertBefore(createNoteBarrier());var lastNote=noteSegments.slice(-1)[0].find(isNotWithinNote),adjacentTextNode=lastNote&&lastNote.find(isNotEmpty);adjacentTextNode&&(adjacentTextNode.vNode.text=""+adjacentTextNode.vNode.text)})}},{"../../utils/create-note-barrier":87,"../../utils/error-handle":90,"../../utils/noting/find-all-notes":95,"../../utils/noting/is-not-within-note":107,"../../utils/vfocus/is-not-empty":123,"../../utils/vfocus/is-vfocus":125,"../../utils/vfocus/is-vtext":126}],72:[function(require,module){"use strict";{var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),addClass=require("../../actions/vdom/add-class"),removeClass=require("../../actions/vdom/remove-class"),generateUUID=(require("../../utils/vfocus/is-vfocus"),require("../../utils/generate-uuid")),addAttribute=require("../vdom/add-attribute");require("../../utils/get-uk-date")}module.exports=function(noteSegments){if(noteSegments){noteSegments=_.isArray(noteSegments)?noteSegments:[noteSegments];var uuid=generateUUID();return noteSegments.forEach(function(note){var node=note.vNode||note;addAttribute(node,"data-note-id",uuid),removeClass(node,"note--start"),removeClass(node,"note--end")}),addClass(noteSegments[0].vNode,"note--start"),addClass(noteSegments[noteSegments.length-1].vNode,"note--end"),noteSegments}}},{"../../actions/vdom/add-class":79,"../../actions/vdom/remove-class":80,"../../utils/generate-uuid":91,"../../utils/get-uk-date":93,"../../utils/vfocus/is-vfocus":125,"../vdom/add-attribute":78,"./../../../bower_components/lodash/dist/lodash.compat.js":2}],73:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),toggleNoteClasses=require("./toggle-note-classes"),findAllNotes=require("../../utils/noting/find-all-notes"),config=require("../../config"),errorHandle=require("../../utils/error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to toggleAllNotesCollapseState, you passed: %s",focus);var notes=findAllNotes(focus);return toggleNoteClasses(notes,config.get("noteCollapsedClass"))}},{"../../config":82,"../../utils/error-handle":90,"../../utils/noting/find-all-notes":95,"../../utils/vfocus/is-vfocus":125,"./toggle-note-classes":74}],74:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),toggleClass=require("../vdom/toggle-class"),addClass=require("../vdom/add-class"),removeClass=require("../vdom/remove-class"),collapseState=require("../../utils/collapse-state"),errorHandle=require("../../utils/error-handle");module.exports=function(notes,className){notes&&className||errorHandle("Only a valid VFocus can be passed to toggleNoteClasses, you passed: %s",focus),notes=_.isArray(notes)?notes:[notes],notes=_.flatten(notes);var action;if(1===notes.length)action=toggleClass;else{var state=collapseState.get();action=state?removeClass:addClass,collapseState.set(!state)}notes.forEach(function(vNode){vNode=vNode.vNode||vNode,action(vNode,className)})}},{"../../utils/collapse-state":86,"../../utils/error-handle":90,"../vdom/add-class":79,"../vdom/remove-class":80,"../vdom/toggle-class":81,"./../../../bower_components/lodash/dist/lodash.compat.js":2}],75:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),toggleNoteClasses=require("./toggle-note-classes"),findSelectedNote=require("../../utils/noting/find-selected-note"),config=require("../../config"),errorHandle=require("../../utils/error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to toggleSelectedNoteCollapseState, you passed: %s",focus);var note=findSelectedNote(focus);if(note)return toggleNoteClasses(note,config.get("noteCollapsedClass"))}},{"../../config":82,"../../utils/error-handle":90,"../../utils/noting/find-selected-note":103,"../../utils/vfocus/is-vfocus":125,"./toggle-note-classes":74}],76:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../../utils/vfocus/is-vfocus"),isNoteSegment=require("../../utils/noting/is-note-segment"),errorHandle=require("../../utils/error-handle");module.exports=function(focus){isVFocus(focus)&&focus.parent||errorHandle("Only a valid VFocus can be passed to unWrapNote, you passed: %s",focus),isNoteSegment(focus)||errorHandle("Only a valid VFocus can be passed to unWrapnote, you passed: %s",focus);var note=focus.vNode,tree=focus.parent.vNode?focus.parent.vNode.children:focus.parent.children;return tree.splice(tree.indexOf(note),1,note.children),focus.parent.vNode.children=_.flatten(tree),focus.vNode=focus.parent.vNode,focus.parent=focus.parent.parent,focus}},{"../../utils/error-handle":90,"../../utils/noting/is-note-segment":108,"../../utils/vfocus/is-vfocus":125,"./../../../bower_components/lodash/dist/lodash.compat.js":2}],77:[function(require,module){"use strict";var config=require("../../config"),_=require("./../../../bower_components/lodash/dist/lodash.compat.js"),h=require("virtual-hyperscript"),getUKDate=require("../../utils/get-uk-date");module.exports=function(focus,data){var notes=_.isArray(focus)?focus:[focus];data=_.extend({},data||{});var tagName=config.get("tagName")+"."+config.get("className");return h(tagName,{title:getUKDate(data),dataset:data},notes)}},{"../../config":82,"../../utils/get-uk-date":93,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"virtual-hyperscript":30}],78:[function(require,module){"use strict";var toCamelCase=require("../../utils/to-camel-case");module.exports=function(node,key,val){node=node.vNode||node,node.properties.dataset=node.properties.dataset||{},/^data-.+/.test(key)?(key=toCamelCase(key.replace(/data-/,"")),node.properties.dataset[key]=val):node.properties[key]=val}},{"../../utils/to-camel-case":113}],79:[function(require,module){"use strict";var hasClass=require("../../utils/vdom/has-class"),errorHandle=require("../../utils/error-handle");module.exports=function(vNode,className){return vNode&&className||errorHandle("A valid vNode and class name must be passed to addClass, you passed: %s, %s",vNode,className),hasClass(vNode,className)?vNode:vNode.properties.className?(vNode.properties.className=vNode.properties.className+" "+className,vNode):(vNode.properties.className=className,vNode)}},{"../../utils/error-handle":90,"../../utils/vdom/has-class":115}],80:[function(require,module){"use strict";var hasClass=require("../../utils/vdom/has-class"),errorHandle=require("../../utils/error-handle");module.exports=function(vNode,className){if(vNode&&className||errorHandle("Onlu a valid vNode and class name can be passed to removeClass, you passed: %s, %s",vNode,className),!hasClass(vNode,className))return vNode;var regex=new RegExp(className,["g"]);vNode.properties.className.replace(regex,"");var classNames=vNode.properties.className.split(" "),index=classNames.indexOf(className);return classNames.splice(index,1),vNode.properties.className=classNames.join(" "),vNode}},{"../../utils/error-handle":90,"../../utils/vdom/has-class":115}],81:[function(require,module){"use strict";var isVFocus=require("../../utils/vfocus/is-vfocus"),hasClass=require("../../utils/vdom/has-class"),addClass=require("./add-class"),removeClass=require("./remove-class"),errorHandle=require("../../utils/error-handle");module.exports=function(vNode,className){return isVFocus(vNode)&&(vNode=vNode.vNode),vNode&&className||errorHandle("A valid vNode and class name must be passed to toggleClass, you passed: %s, %s",vNode,className),hasClass(vNode,className)?removeClass(vNode,className):addClass(vNode,className)}},{"../../utils/error-handle":90,"../../utils/vdom/has-class":115,"../../utils/vfocus/is-vfocus":125,"./add-class":79,"./remove-class":80}],82:[function(require,module){"use strict";var _=require("./../../bower_components/lodash/dist/lodash.compat.js"),config={user:"unknown",nodeName:"GU-NOTE",tagName:"gu-note",defaultTagName:"gu-note",className:"note",defaultClassName:"note",dataName:"data-note-edited-by",dataNameCamel:"dataNoteEditedBy",dataDate:"data-note-edited-date",dataDateCamel:"dataNoteEditedDate",noteBarrierTag:"gu-note-barrier",noteCollapsedClass:"note--collapsed",scribeInstanceSelector:".scribe",selectors:[{commandName:"note",tagName:"gu-note",keyCodes:[119,121,{altKey:8}]}]};module.exports={get:function(key){return key?config[key]||void 0:config},set:function(key,val){_.isObject(key)&&(config=_.extend({},config,key)),config[key]=val}}},{"./../../bower_components/lodash/dist/lodash.compat.js":2}],83:[function(require,module){"use strict";var _prototypeProperties=function(child,staticProps,instanceProps){staticProps&&Object.defineProperties(child,staticProps),instanceProps&&Object.defineProperties(child.prototype,instanceProps)},_=require("./../bower_components/lodash/dist/lodash.compat.js"),config=require("./config"),emitter=require("./utils/emitter"),noteCollapseState=require("./utils/collapse-state"),NoteCommandFactory=require("./note-command-factory"),findScribeMarkers=require("./utils/noting/find-scribe-markers"),isSelectionWithinNote=require("./utils/noting/is-selection-within-note"),removeNote=require("./actions/noting/remove-note"),removePartOfNote=require("./actions/noting/remove-part-of-note"),createEmptyNoteAtCaret=require("./actions/noting/create-note-at-caret"),createNoteFromSelection=require("./actions/noting/create-note-from-selection"),ensureNoteIntegrity=require("./actions/noting/ensure-note-integrity"),toggleSelectedNoteCollapseState=require("./actions/noting/toggle-selected-note-collapse-state"),toggleAllNoteCollapseState=require("./actions/noting/toggle-all-note-collapse-state"),notingVDom=require("./noting-vdom"),mutate=notingVDom.mutate,mutateScribe=notingVDom.mutateScribe;
module.exports=function(scribe,attrs){var NoteController=function(){function NoteController(){var _this=this;config.set(attrs),config.get("selectors").forEach(function(selector){NoteCommandFactory(scribe,selector.commandName,selector.tagName)}),scribe.el.addEventListener("keydown",function(e){return _this.onNoteKeyAction(e)}),scribe.el.addEventListener("click",function(e){return _this.onElementClicked(e)}),scribe.el.addEventListener("input",function(e){return _this.validateNotes(e)}),emitter.on("command:note",function(tag){return _this.note(tag)}),emitter.on("command:toggle:single-note",function(tag){return _this.toggleSelectedNotes(tag)}),emitter.on("command:toggle:all-notes",function(tag){return _this.toggleAllNotes(tag)})}return _prototypeProperties(NoteController,null,{onNoteKeyAction:{value:function(e){var _this2=this,selectors=config.get("selectors");selectors.forEach(function(selector){var tagName=selector.tagName;selector.keyCodes.forEach(function(keyCode){if(_.isObject(keyCode)||e.keyCode!==keyCode){if(_.isObject(keyCode)){var modifier=Object.keys(keyCode)[0];e[modifier]&&e.keyCode===keyCode[modifier]&&(e.preventDefault(),_this2.note(tagName))}}else e.preventDefault(),_this2.note(tagName)})})},writable:!0,enumerable:!0,configurable:!0},onElementClicked:{value:function(e){var _this3=this,selectors=config.get("selectors");selectors.forEach(function(selector){if(e.target.nodeName===selector.tagName.toUpperCase()){e.preventDefault();var vSelection=new scribe.api.Selection,range=document.createRange();range.selectNodeContents(e.target),vSelection.selection.removeAllRanges(),vSelection.selection.addRange(range),_this3.toggleSelectedNotes()}})},writable:!0,enumerable:!0,configurable:!0},note:{value:function(){void 0===arguments[0]?config.get("defaultTagName"):arguments[0];return function(){mutateScribe(scribe,function(focus){var markers=findScribeMarkers(focus),selectionIsCollapsed=1===markers.length,isWithinNote=isSelectionWithinNote(markers);selectionIsCollapsed&&isWithinNote?removeNote(focus):isWithinNote?removePartOfNote(focus):selectionIsCollapsed?createEmptyNoteAtCaret(focus):createNoteFromSelection(focus)})}()},writable:!0,enumerable:!0,configurable:!0},toggleSelectedNotes:{value:function(){mutateScribe(scribe,function(focus){return toggleSelectedNoteCollapseState(focus)})},writable:!0,enumerable:!0,configurable:!0},toggleAllNotes:{value:function(){var scribeInstances=(!!noteCollapseState.get(),document.querySelectorAll(config.get("scribeInstanceSelector")));scribeInstances=_.toArray(scribeInstances),scribeInstances.forEach(function(instance){mutate(instance,function(focus){return toggleAllNoteCollapseState(focus)})})},writable:!0,enumerable:!0,configurable:!0},validateNotes:{value:function(){_.throttle(function(){mutateScribe(scribe,function(focus){return ensureNoteIntegrity(focus)})},1e3)()},writable:!0,enumerable:!0,configurable:!0}}),NoteController}();return new NoteController}},{"./../bower_components/lodash/dist/lodash.compat.js":2,"./actions/noting/create-note-at-caret":62,"./actions/noting/create-note-from-selection":63,"./actions/noting/ensure-note-integrity":64,"./actions/noting/remove-note":68,"./actions/noting/remove-part-of-note":69,"./actions/noting/toggle-all-note-collapse-state":73,"./actions/noting/toggle-selected-note-collapse-state":75,"./config":82,"./note-command-factory":84,"./noting-vdom":85,"./utils/collapse-state":86,"./utils/emitter":89,"./utils/noting/find-scribe-markers":102,"./utils/noting/is-selection-within-note":110}],84:[function(require,module){"use strict";function generateNoteCommand(scribe,tagName){var command=new scribe.api.Command("insertHTML");return command.execute=function(){emitter.trigger("command:note",[tagName])},command.queryState=function(){var selection=new scribe.api.Selection;return isSelectionWithinANote(selection.range,scribe.el)},command.queryEnabled=function(){return!0},command}function generateToggleSingleNoteCommand(scribe,tagName){var command=new scribe.api.Command("insertHTML");return command.execute=function(){emitter.trigger("command:toggle:single-note",[tagName])},command}function generateToggleAllNotesCommand(scribe,tagName){var command=new scribe.api.Command("insertHTML");return command.execute=function(){emitter.trigger("command:toggle:all-notes",[tagName])},command.queryEnabled=function(){return!!scribe.el.getElementsByTagName(tagName).length},command.queryState=function(){return this.queryEnabled()&&noteCollapseState.get()},command}var emitter=require("./utils/emitter"),noteCollapseState=(require("./config"),require("./utils/collapse-state")),isSelectionWithinANote=require("./utils/is-dom-selection-within-a-note");module.exports=function(scribe){var commandName=void 0===arguments[1]?"note":arguments[1],tagName=void 0===arguments[2]?"gu-note":arguments[2];scribe.commands[commandName]=generateNoteCommand(scribe,tagName);var toggleSingleNoteCommandName=commandName+"CollapseToggle";scribe.commands[toggleSingleNoteCommandName]=generateToggleSingleNoteCommand(scribe,tagName);var toggleAllNotesCommandName=toggleSingleNoteCommandName+"All";scribe.commands[toggleAllNotesCommandName]=generateToggleAllNotesCommand(scribe,tagName)}},{"./config":82,"./utils/collapse-state":86,"./utils/emitter":89,"./utils/is-dom-selection-within-a-note":94}],85:[function(require,module,exports){"use strict";var diff=(require("./../bower_components/lodash/dist/lodash.compat.js"),require("virtual-dom/diff")),patch=require("virtual-dom/patch"),virtualize=require("vdom-virtualize"),VFocus=(require("vtree/is-vtext"),require("./vfocus"));exports.mutate=function(domElement,callback){var originalTree=virtualize(domElement),tree=virtualize(domElement),treeFocus=new VFocus(tree);callback(treeFocus);var patches=diff(originalTree,tree);patch(domElement,patches)},exports.mutateScribe=function(scribe,callback){var selection=new scribe.api.Selection;scribe.transactionManager.run(function(){selection.placeMarkers(),exports.mutate(scribe.el,function(treeFocus){callback(treeFocus,selection)}),selection.selectMarkers(),selection.removeMarkers()})}},{"./../bower_components/lodash/dist/lodash.compat.js":2,"./vfocus":127,"vdom-virtualize":9,"virtual-dom/diff":16,"virtual-dom/patch":26,"vtree/is-vtext":54}],86:[function(require,module){"use strict";var state=!1;module.exports={get:function(){return state},set:function(val){state=val}}},{}],87:[function(require,module){"use strict";var VText=require("vtree/vtext");module.exports=function(){return new VText("")}},{"vtree/vtext":60}],88:[function(require,module){"use strict";var h=require("virtual-hyperscript");module.exports=function(){return h("em.scribe-marker")}},{"virtual-hyperscript":30}],89:[function(require,module){"use strict";var EventEmitter=require("./../../bower_components/scribe/src/event-emitter");module.exports=new EventEmitter},{"./../../bower_components/scribe/src/event-emitter":3}],90:[function(require,module){"use strict";var _toArray=function(arr){return Array.isArray(arr)?arr:Array.from(arr)},util=require("util");module.exports=function(message){for(var objs=[],_key=1;_key<arguments.length;_key++)objs[_key-1]=arguments[_key];var errorMsg=util.format.apply(util,[message].concat(_toArray(objs.map(function(obj){return util.inspect(obj,{depth:null})}))));throw new Error(errorMsg)}},{util:8}],91:[function(require,module){"use strict";module.exports=function(){var d=(new Date).getTime(),uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"==c?r:7&r|8).toString(16)});return uuid}},{}],92:[function(require,module){"use strict";var config=require("../config");module.exports=function(){var user=config.get("user");return{noteEditedBy:user,noteEditedDate:(new Date).toISOString()}}},{"../config":82}],93:[function(require,module){"use strict";var DATA_DATE_CAMEL="noteEditedDate",config=require("../config");module.exports=function(data){data=data||{};var date=data[DATA_DATE_CAMEL]?new Date(data[DATA_DATE_CAMEL]):new Date,name=config.get("user"),formattedDate=[date.getDate()+"/"+(date.getMonth()+1)+"/"+date.getFullYear(),"at",date.getHours()+":"+(date.getMinutes()<9?"0":"")+date.getMinutes()].join(" ");return name+" "+formattedDate}},{"../config":82}],94:[function(require,module){"use strict";var config=require("../config");module.exports=function(selectionRange,parentContainer){function domWalkUpFind(node,isTargetNode){return node.parentNode&&node!==parentContainer?isTargetNode(node)?node:domWalkUpFind(node.parentNode,isTargetNode):!1}function domFindAncestorNote(node){return domWalkUpFind(node,function(node){return node.tagName===config.get("nodeName")})}return domFindAncestorNote(selectionRange.startContainer)&&domFindAncestorNote(selectionRange.endContainer)&&!0}},{"../config":82}],95:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../vfocus/is-vfocus"),isNoteSegment=require("./is-note-segment"),findEntireNote=require("./find-entire-note"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findAllNotes, you passed: ",focus),focus.filter(isNoteSegment).map(findEntireNote).reduce(function(uniqueNotes,note){return 0===uniqueNotes.length?uniqueNotes.concat([note]):_.last(uniqueNotes)[0].vNode===note[0].vNode?uniqueNotes:uniqueNotes.concat([note])},[])}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"./find-entire-note":97,"./is-note-segment":108}],96:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),isScribeMarker=require("./is-scribe-marker"),isNotScribeMarker=require("./is-not-scribe-marker"),errorHandle=require("../error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findBetweenScribeMarkers, you passed: %s",focus);var startFocus=focus.find(isScribeMarker);return startFocus?startFocus.next().takeWhile(isNotScribeMarker):[]}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./is-not-scribe-marker":106,"./is-scribe-marker":109}],97:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),isWithinNote=require("./is-within-note"),isNoteSegment=require("./is-note-segment"),findFirstNoteSegment=require("./find-first-note-segment"),errorHandle=require("../error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findEntireNote, you passed: %s",focus);var firstNoteSegment=findFirstNoteSegment(focus);if(firstNoteSegment)return firstNoteSegment.takeWhile(isWithinNote).filter(isNoteSegment)}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./find-first-note-segment":98,"./is-note-segment":108,"./is-within-note":111}],98:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../vfocus/is-vfocus"),isWithinNote=require("./is-within-note"),isNoteSegment=require("./is-note-segment"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Onlu a valid VFocus can be passed to findFirstNoteSegment, you passed: %s",focus),_.last(focus.takeWhile(isWithinNote,"prev").filter(isNoteSegment))}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"./is-note-segment":108,"./is-within-note":111}],99:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),isWithinNote=require("./is-within-note"),isNoteSegment=require("./is-note-segment"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("only a valid VFocus can be passed to findFirstNoteSegment, you passed: %s",focus),focus.takeWhile(isWithinNote).filter(isNoteSegment).splice(-1)[0]}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./is-note-segment":108,"./is-within-note":111}],100:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../vfocus/is-vfocus"),hasNoteId=require("./has-note-id"),findAllNotes=require("./find-all-notes"),errorHandle=require("../error-handle");module.exports=function(focus,noteId){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findNoteById, you passed: ",focus);var allNoteSegments=_.flatten(findAllNotes(focus));return allNoteSegments.filter(function(segment){return hasNoteId(segment.vNode,noteId)})}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"./find-all-notes":95,"./has-note-id":105}],101:[function(require,module){"use strict";var isNoteSegment=require("../noting/is-note-segment"),isVFocus=require("../vfocus/is-vfocus"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findParentNoteSegments, you passed: %s",focus),focus.find(isNoteSegment,"up")}},{"../error-handle":90,"../noting/is-note-segment":108,"../vfocus/is-vfocus":125}],102:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),isScribeMarker=require("./is-scribe-marker"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findScribeMarkers, you passed: %s",focus),focus.filter(isScribeMarker)}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./is-scribe-marker":109}],103:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),findScribeMarkers=(require("../../vfocus"),require("./find-scribe-markers")),findParentNoteSegment=require("./find-parent-note-segment"),findEntireNote=require("./find-entire-note"),errorHandle=require("../error-handle");module.exports=function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findselectedNote, you passed: %s",focus);var markers=findScribeMarkers(focus);if(!(markers.length<=0)){var firstMarker=markers[0],note=findParentNoteSegment(firstMarker);if(note)return note&&findEntireNote(note)||void 0}}},{"../../vfocus":127,"../error-handle":90,"../vfocus/is-vfocus":125,"./find-entire-note":97,"./find-parent-note-segment":101,"./find-scribe-markers":102}],104:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),findBetweenScribeMarkers=require("./find-between-scribe-markers"),findTextNodes=require("../vfocus/find-text-nodes"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findTextBetweenScribeMarkers, you passed: %s",focus),findTextNodes(findBetweenScribeMarkers(focus))}},{"../error-handle":90,"../vfocus/find-text-nodes":118,"../vfocus/is-vfocus":125,"./find-between-scribe-markers":96}],105:[function(require,module){"use strict";{var hasAttribute=require("../vdom/has-attribute");require("../vfocus/is-vfocus")}module.exports=function(vNode,value){return hasAttribute(vNode,"data-note-id",value)}},{"../vdom/has-attribute":114,"../vfocus/is-vfocus":125}],106:[function(require,module){"use strict";var isScribeMarker=require("./is-scribe-marker");module.exports=function(focus){return!isScribeMarker(focus)}},{"./is-scribe-marker":109}],107:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),findParentNoteSegment=require("./find-parent-note-segment"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to isNotWithinNote, you passed: %s",focus),!findParentNoteSegment(focus)}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./find-parent-note-segment":101}],108:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),isTag=require("../vdom/is-tag"),errorHandle=require("../error-handle");module.exports=function(vfocus){return isVFocus(vfocus)||errorHandle("Only a valid VFocus element can be passed to isNote, you passed: %s",focus),isTag(vfocus.vNode,"gu-note")}},{"../error-handle":90,"../vdom/is-tag":117,"../vfocus/is-vfocus":125}],109:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),hasClass=require("../vdom/has-class"),errorHandle=require("../error-handle");module.exports=function(vfocus){return isVFocus(vfocus)||errorHandle("Only a valid VFocus element can be passed to isNote, you passed: %s",focus),hasClass(vfocus.vNode,"scribe-marker")}},{"../error-handle":90,"../vdom/has-class":115,"../vfocus/is-vfocus":125}],110:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../vfocus/is-vfocus"),findParentNoteSegment=require("./find-parent-note-segment"),isNotScribeMarker=require("./is-not-scribe-marker"),isVText=require("../vfocus/is-vtext"),findScribeMarkers=require("./find-scribe-markers"),errorHandle=require("../error-handle");module.exports=function(markers){if(isVFocus(markers)&&(markers=findScribeMarkers(markers)),_.isArray(markers)||errorHandle("Only an array of markers or valid VFocus can be passed to isSelectionBetweenMarkers, you passed: %s",focus),!(markers.length<=0)){if(2===markers.length){var selection=markers[0].next().takeWhile(isNotScribeMarker).filter(isVText);return selection.every(findParentNoteSegment)}return!!findParentNoteSegment(markers[0])}}},{"../error-handle":90,"../vfocus/is-vfocus":125,"../vfocus/is-vtext":126,"./../../../bower_components/lodash/dist/lodash.compat.js":2,"./find-parent-note-segment":101,"./find-scribe-markers":102,"./is-not-scribe-marker":106}],111:[function(require,module){"use strict";var isVFocus=require("../vfocus/is-vfocus"),isVText=require("../vfocus/is-vtext"),isEmpty=require("../vfocus/is-empty"),findParentNote=require("../noting/find-parent-note-segment"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to isWithinNote, you passed: %s",focus),!isVText(focus)||isEmpty(focus)||!!findParentNote(focus)}},{"../error-handle":90,"../noting/find-parent-note-segment":101,"../vfocus/is-empty":122,"../vfocus/is-vfocus":125,"../vfocus/is-vtext":126}],112:[function(require,module){"use strict";function getNotesCache(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to notesCache.get, you passed: %s",focus),cache&&0!==cache.length||(cache=setNotesCache(focus)),cache}function setNotesCache(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to notesCache.set, you passed: %s",focus),cache=findAllNotes(focus)}var cache,isVFocus=require("../vfocus/is-vfocus"),findAllNotes=require("./find-all-notes"),errorHandle=require("../error-handle");module.exports={get:getNotesCache,set:setNotesCache}},{"../error-handle":90,"../vfocus/is-vfocus":125,"./find-all-notes":95}],113:[function(require,module){"use strict";module.exports=function(string){return string.replace(/(\-[a-z])/g,function($1){return $1.toUpperCase().replace("-","")})}},{}],114:[function(require,module){"use strict";var toCamelCase=require("../to-camel-case"),errorHandle=require("../error-handle");module.exports=function(vNode,attribute,value){vNode&&attribute||errorHandle("Incorrect arguments passed to hasAttribute, you passed: %s",arguments);var isTestingDataAttib=/data/.test(attribute),hasDataSet=!!vNode.properties&&!!vNode.properties.dataset;return isTestingDataAttib&&hasDataSet?(attribute=attribute.substring(5,attribute.length),attribute=toCamelCase(attribute),vNode.properties.dataset[attribute]===value):vNode.properties[attribute]?vNode.properties[attribute].value?vNode.properties[attribute].value===value:vNode.properties[attribute]===value:!1}},{"../error-handle":90,"../to-camel-case":113}],115:[function(require,module){"use strict";require("./../../../bower_components/lodash/dist/lodash.compat.js");module.exports=function(vNode,value){if(!vNode||!vNode.properties||!vNode.properties.className)return!1;var regEx=new RegExp(value);return regEx.test(vNode.properties.className)}},{"./../../../bower_components/lodash/dist/lodash.compat.js":2}],116:[function(require,module){"use strict";var isVText=(require("./../../../bower_components/lodash/dist/lodash.compat.js"),require("vtree/is-vtext"));module.exports=function(node){if(isVText(node)){var text=node.text;return""===text||""===text||""===text||" "===text}return node.children.length<=0}},{"./../../../bower_components/lodash/dist/lodash.compat.js":2,"vtree/is-vtext":54}],117:[function(require,module){"use strict";module.exports=function(node,tag){return node.tagName&&node.tagName.toLowerCase()===tag}},{}],118:[function(require,module){"use strict";var _=require("./../../../bower_components/lodash/dist/lodash.compat.js"),isVFocus=require("../vfocus/is-vfocus"),isVText=require("../vfocus/is-vtext"),errorHandle=require("../error-handle");module.exports=function(focuses){return focuses=_.isArray(focuses)?focuses:[focuses],focuses.forEach(function(focus){isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to findTextNodes, you passed: %s",focus)}),focuses.filter(isVText)}},{"../error-handle":90,"../vfocus/is-vfocus":125,"../vfocus/is-vtext":126,"./../../../bower_components/lodash/dist/lodash.compat.js":2}],119:[function(require,module){"use strict";var isVFocus=require("./is-vfocus"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus element can be passed to flattenTree, you passed: %s",focus),focus.takeWhile(function(insideOfFocus){return!!insideOfFocus.find(function(f){return f.vNode===focus.vNode},"up")})}},{"../error-handle":90,"./is-vfocus":125}],120:[function(require,module){"use strict";var isVFocus=require("./is-vfocus"),flatten=require("./flatten-tree"),isVText=require("./is-vtext"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus element can be passed to hasNoTextChildren, you passed: %s",focus),0===flatten(focus).filter(isVText).length}},{"../error-handle":90,"./flatten-tree":119,"./is-vfocus":125,"./is-vtext":126}],121:[function(require,module){"use strict";var isVFocus=require("./is-vfocus"),flatten=require("./flatten-tree"),isVText=require("./is-vtext"),isEmpty=require("./is-empty"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to hasNoTextChildren, you passed: %s",focus),flatten(focus).filter(isVText).every(isEmpty)}},{"../error-handle":90,"./flatten-tree":119,"./is-empty":122,"./is-vfocus":125,"./is-vtext":126}],122:[function(require,module){"use strict";var isVFocus=require("./is-vfocus"),isEmpty=require("../vdom/is-empty"),errorHandle=require("../error-handle");module.exports=function(vfocus){return isVFocus(vfocus)||errorHandle("Onlu a valid VFocus can be passed to isEmptyVFocus, you passed: %s",focus),isEmpty(vfocus.vNode)}},{"../error-handle":90,"../vdom/is-empty":116,"./is-vfocus":125}],123:[function(require,module){"use strict";var isVFocus=require("./is-vfocus"),isVText=require("./is-vtext"),isEmpty=require("./is-empty.js"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus can be passed to isNotEmpty, you passed: %s",focus),isVText(focus)&&!isEmpty(focus)}},{"../error-handle":90,"./is-empty.js":122,"./is-vfocus":125,"./is-vtext":126}],124:[function(require,module){"use strict";var isVFocus=require("./is-vfocus.js"),isTag=require("../vdom/is-tag.js"),errorHandle=require("../error-handle");module.exports=function(focus){return isVFocus(focus)||errorHandle("Only a valid VFocus element can be passed to isParagraphVFocus, you passed: %s",focus),isTag(focus.vNode,"p")}},{"../error-handle":90,"../vdom/is-tag.js":117,"./is-vfocus.js":125}],125:[function(require,module){"use strict";var VFocus=require("../../vfocus");module.exports=function(vFocus){return vFocus instanceof VFocus}},{"../../vfocus":127}],126:[function(require,module){"use strict";var isVText=require("vtree/is-vtext"),isVFocus=(require("../../vfocus"),require("../vfocus/is-vfocus")),errorHandle=require("../error-handle");module.exports=function(vfocus){return isVFocus(vfocus)||errorHandle("Only a valid VFocus can be pased to isVTextVFocus, you passed: %s",focus),isVText(vfocus.vNode)}},{"../../vfocus":127,"../error-handle":90,"../vfocus/is-vfocus":125,"vtree/is-vtext":54}],127:[function(require,module){"use strict";function VFocus(vNode,parent){this.vNode=vNode,this.parent=parent}module.exports=VFocus,VFocus.prototype.rightVNode=function(){if(this.isRoot())return null;var rightVNodeIndex=this.parent.vNode.children.indexOf(this.vNode)+1;return this.parent.vNode.children[rightVNodeIndex]},VFocus.prototype.leftVNode=function(){if(this.isRoot())return null;var leftVNodeIndex=this.parent.vNode.children.indexOf(this.vNode)-1;return leftVNodeIndex>=0?this.parent.vNode.children[leftVNodeIndex]:null},VFocus.prototype.isRoot=function(){return!this.parent},VFocus.prototype.canRight=function(){return!!this.rightVNode()},VFocus.prototype.canLeft=function(){return!!this.leftVNode()},VFocus.prototype.canDown=function(){return this.vNode.children&&this.vNode.children.length?!0:!1},VFocus.prototype.canUp=function(){return!this.isRoot()},VFocus.prototype.next=function(){function upThenRightWhenPossible(vFocus){return vFocus?vFocus.right()||upThenRightWhenPossible(vFocus.up()):null}return this.down()||this.right()||upThenRightWhenPossible(this)},VFocus.prototype.prev=function(){function downFurthestRight(vFocus){function furthestRight(vFocus){for(var focus=vFocus;focus.canRight();)focus=focus.right();return focus}return vFocus.canDown()?downFurthestRight(vFocus.down()):furthestRight(vFocus)}var focus;return focus=this.left()&&this.left().down()?downFurthestRight(this.left()):this.left()?this.left():this.up()},VFocus.prototype.down=function(){return this.canDown()?new VFocus(this.vNode.children[0],this):null},VFocus.prototype.up=function(){return this.canUp()?this.parent:null},VFocus.prototype.right=function(){return this.canRight()?new VFocus(this.rightVNode(),this.parent):null},VFocus.prototype.left=function(){return this.canLeft()?new VFocus(this.leftVNode(),this.parent):null},VFocus.prototype.top=function(){return this.canUp()?this.parent.top():this},VFocus.prototype.replace=function(replacementVNode){if(this.isRoot())this.vNode=replacementVNode;else{var vNodeIndex=this.parent.vNode.children.indexOf(this.vNode);this.parent.vNode.children.splice(vNodeIndex,1,replacementVNode),this.vNode=replacementVNode}return this},VFocus.prototype.remove=function(){if(this.isRoot());else{var vNodeIndex=this.parent.vNode.children.indexOf(this.vNode);this.parent.vNode.children.splice(vNodeIndex,1)}return this},VFocus.prototype.insertBefore=function(newVNodes){var newVNodes=newVNodes instanceof Array?newVNodes:[newVNodes];if(this.isRoot());else{var siblings=this.parent.vNode.children,vNodeIndex=siblings.indexOf(this.vNode);newVNodes.reverse().forEach(function(vNode){siblings.splice(vNodeIndex,0,vNode)})}return this},VFocus.prototype.insertAfter=function(newVNodes){var newVNodes=newVNodes instanceof Array?newVNodes:[newVNodes];if(this.isRoot());else{var siblings=this.parent.vNode.children,vNodeIndex=siblings.indexOf(this.vNode);siblings.length===vNodeIndex+1?siblings=siblings.concat(newVNodes):newVNodes.reverse().forEach(function(vNode){siblings.splice(vNodeIndex+1,0,vNode)})}return this},VFocus.prototype.refresh=function(){function myself(focus){return focus.vNode===self.vNode}var self=this,me=this.top().find(myself);return this.parent=me.parent,this},VFocus.prototype.forEach=function(fn){for(var node=this;node;)fn(node),node=node.next()},VFocus.prototype.flatten=function(){var focuses=[];return this.forEach(function(focus){focuses.push(focus)}),focuses},VFocus.prototype.takeWhile=function(predicate,movement){for(var movement=movement||"next",focus=this,acc=[];focus&&predicate(focus);)acc.push(focus),focus=focus[movement]();return acc},VFocus.prototype.filter=function(predicate,movement){var movement=movement||"next",results=[];return this.forEach(function(focus){predicate(focus)&&results.push(focus)},movement),results},VFocus.prototype.find=function(predicate,movement){for(var movement=movement||"next",focus=this;focus&&!predicate(focus);)focus=focus[movement]();return focus}},{}]},{},[61])(61)});
//# sourceMappingURL=./build/scribe-plugin-noting.js.map